<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Bridges|COM Export Bridge|Examples">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Tri-Window COM Export Example</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../Bridges.htm">Bridges</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbsSelf">COM Export Bridge</span><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbsSelf">Examples</span><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Tri-Window COM Export Example</span>
        </div>
        <h1><a name="Tri-Window_COM_Export_Example"></a><a name="kanchor5189"></a>Tri-Window COM Export <a name="kanchor5190"></a>Example</h1>
        <p>The <code>examples/doc/bridges </code>directory includes three object definition files that inherit from the three types of drawable objects: IDLgrWindow, IDLitDirectWindow and IDLitWindow. The following example uses the Export Bridge Assistant to create ActiveX controls from these object definition files and then creates a Windows application in Visual Basic .NET that includes the three controls.</p>
        <h2>Example Code</h2>
        <p>The object definition files,  <code>idlgrwindowexample__define.pro</code>, <code>idlitdirectwindowexample__define.pro</code>, and <code>idlitwindowexample__define.pro</code> are located in the</p>
        <p><code>examples/doc/bridges</code> subdirectory of the IDL distribution.</p>
        <p>Open the Export Bridge Assistant by entering IDLEXBR_ASSISTANT at the IDL command line and then complete the following steps to export the three drawable objects.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>Export Bridge Assistant details are available in <a href="../ExportFromIDL - Export Bridge Assistant/SpecifyingInformationForExporting.htm#Specifying_Information_For_Exporting">Specifying Information for Exporting</a>. Refer to that section if you need more information about the following items.</p>
        <h3>Wrap the IDLitDirectWindow Example</h3>
        <p>The object defined in <code>idlitdirectwindowexample__define.pro</code> inherits from IDLitDirectWindow and creates a drawing canvas that you can write on using your mouse.</p>
        <ol>
            <li value="1">Select <b>File &gt; New Project &gt; COM</b>, browse to select <code>idlitdirectwindowexample__define.pro</code> from the <code>examples/doc/bridges</code> directory, and click <b>Open</b>.</li>
            <li value="2">Set export object characteristics as described in the following table. When you select the tree view item, listed in the left column, configure the related properties as noted in the right column.</li>
            <table style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/Description.css');" class="TableStyle_Description" cellspacing="0">
                <col />
                <col />
                <thead>
                    <tr>
                        <th class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                            <p>Tree View Item</p>
                        </th>
                        <th class="TableStyle_Description_Head_0_0_RowSep_ColEnd">Property Configuration</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                            <p>IDL Export Bridge Project</p>
                        </td>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                            <p>	Accept the default value or make changes as desired:</p>
                            <ul>
                                <li value="1"> Output classname</li>
                                <li value="2"> Process name</li>
                                <li value="3"> Output directory</li>
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                            <p>idlitdirectwindowexample</p>
                        </td>
                        <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                            <p>Drawable object equals True</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                            <p>WINDOW_INDEX property</p>
                        </td>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                            <p>You do not need to export the WINDOW_INDEX property as the control will always know it’s own index number. You can leave all fields unchanged.</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
                            <p>MAKECURRENT method</p>
                        </td>
                        <td class="TableStyle_Description_Body_1_0_RowEnd_ColEnd">
                            <p>Export — False. This is only used within methods in the IDL source object definition file.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <li value="3">Save the project by selecting <b>File &gt; Save project</b>. Accept the default name and location or make changes as desired.</li>
            <li value="4">Verify that the object elements you want to export are listed in the Export log panel. If the expected items are not present, one or more items may still have an UNSPECIFIED field value that must be changed.</li>
            <li value="5">Build the export object by selecting <b>Build &gt; Build object</b>. The <b>Build log</b> panel shows the results of the build process. For a drawable object, <code>.tlb</code> and <code>.ocx</code> files (named based on the object name) are created in the <b>Output directory</b>.</li>
        </ol>
        <h3>Wrap the IDLgrWindow Example</h3>
        <p>The object defined in <code>idlgrwindowexample__define.pro</code> inherits from IDLgrWindow and displays a globe that can be rotated using your mouse.</p>
        <ol>
            <li value="1">Select <b>File &gt; New Project &gt; COM</b>, browse to select <code>idlgrwindowexample__define.pro</code> from the <code>examples/doc/bridges</code> directory, and click <b>Open</b>.</li>
            <li value="2">Set export object characteristics as described in the following table. When you select the tree view item, listed in the left column, configure the related properties as noted in the right column.</li>
            <table style="mc-table-style: url('../../Resources/TableStyles/Description.css');margin-left: 0;margin-right: auto;" class="TableStyle_Description" cellspacing="0">
                <col />
                <col />
                <thead>
                    <tr>
                        <th class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                            <p>Tree View Item</p>
                        </th>
                        <th class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                            <p>Property Configuration</p>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                            <p>IDL Export Bridge Project</p>
                        </td>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                            <p>	Accept the default value or make changes as desired:</p>
                            <ul>
                                <li value="1">Output classname</li>
                                <li value="2"> Process name</li>
                                <li value="3">Output directory</li>
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                            <p>idlgrwindowexample</p>
                        </td>
                        <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                            <p>	Drawable object equals True</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                            <p>CREATEOBJECTS method</p>
                        </td>
                        <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd">
                            <p>Export — False. This method is not called from the COM client.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <li value="3">Save the project by selecting <b>File &gt; Save project</b>. Accept the default name and location or make changes as desired.</li>
            <li value="4">Verify that the object elements you want to export are listed in the Export log panel. If the expected items are not present, one or more items may still have an UNSPECIFIED field value that must be changed.</li>
            <li value="5">Build the export object by selecting <b>Build &gt; Build object</b>. The <b>Build log</b> panel shows the results of the build process. For a drawable object, <code>.tlb</code> and <code>.ocx</code> files (named based on the object name) are created in the <b>Output directory</b>.</li>
        </ol>
        <h3>Wrap the IDLitWindow Example</h3>
        <p>The object defined in idlitwindowexample__define.pro inherits from IDLitWindow and displays a surface in a view in which you can pan and zoom.</p>
        <ol>
            <li value="1">Select <b>File &gt; New Project &gt; COM</b>, browse to select <code>idlitwindowexample__define.pro</code> from the <code>examples/doc/bridges</code> directory, and click <b>Open</b>.</li>
            <li value="2">There are no export object characteristics that must be modified, but you can make changes to the default items as described in the following table. When you select the tree view item, listed in the left column, configure the related properties as noted in the right column.</li>
            <table style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/Description.css');" class="TableStyle_Description" cellspacing="0">
                <col />
                <col />
                <thead>
                    <tr>
                        <th class="TableStyle_Description_Head_0_0_RowSep_ColSep">Tree View Item</th>
                        <th class="TableStyle_Description_Head_0_0_RowSep_ColEnd">Property Configuration</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">IDL Export Bridge Project</td>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                            <p>	Accept the default value or make changes as desired:</p>
                            <ul>
                                <li value="1"> Output classname</li>
                                <li value="2"> Process name</li>
                                <li value="3"> Output directory</li>
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">idlitwindowexample</td>
                        <td class="TableStyle_Description_Body_1_0_RowEnd_ColEnd">
                            <p>	Drawable object equals True</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <li value="3">Save the project by selecting <b>File &gt; Save project</b>. Accept the default name and location or make changes as desired.</li>
            <li value="4">Build the export object by selecting <b>Build &gt; Build object</b>. The <b>Build log</b> panel shows the results of the build process. For a drawable object, <code>.tlb</code> and <code>.ocx</code> files (named based on the object name) are created in the <b>Output directory</b>.</li>
        </ol>
        <h3>Register the Controls and Create the Application</h3>
        <ol>
            <li value="1">Register the <code>.ocx</code> files generated by the Export Bridge Assistant using <code>regsvr32</code> (see <a href="../ExportFromIDL - IDL Objects/ConfiguringBuildAndClientMachines.htm#COM_Registration_Requirements">COM Registration Requirements</a> for details if needed). If you kept the default names, you will need to register <code>idlgrwindowexample.ocx</code>, <code>idlitdirectwindowexample.ocx</code>, and <code>idlitwindowexample.ocx</code>.</li>
            <li value="2">Create a new Visual Basic .NET Windows Application and add the <code>idlgrwindowexample Class</code>, <code>idlitdirectwindowexample Class</code>, and <code>idlitwindowexample Class</code> files to the toolbox. Select <b>View &gt; Toolbox</b> and select the desired tab. Right-click and select <b>Add/Remove Items</b>. Select the <b>COM Components</b> tab, place a checkmark next to the class files, and click OK.</li>
            <li value="3">Add the three controls IDL to your form in the order of <code>idlgrwindowexample Class</code>, <code>idlitdirectwindowexample Class</code> and <code>idlitwindowexample Class</code> from left to right.</li>
            <p>
                <img src="../Resources/Images/BridgesFigure12-1.png" />
            </p>
            <li value="4">Replace the default module code with the text in the file referenced below. See code comments for details.</li>
        </ol>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>The text file for this example, <code>com_export_triwindow_doc.txt</code>, is located in the <code>examples/doc/bridges/COM</code> subdirectory of the IDL distribution. This Visual Basic .NET code can be copied from the text file and adopted for use in your COM environment.</p>
        <p>When you build and run the example, the output will appear similar to the following figure.</p>
        <p>
            <img src="../Resources/Images/BridgesFigure12-2.png" />
        </p>
        <p>Left-click and drag in the IDLgrWindow control to rotate the globe and follow the instructions in the IDLitDirectWindow control to draw in the window. In the IDLitWindow, left-click on the surface and drag the mouse cursor to reposition the object, or left-click on one of the view handles and drag up or down to zoom in or out. The bottom label text will change when you move your mouse into or out of the IDLgrWindow- or IDLitDirectWindow-based controls as the label is updated with the NotifyBridge output from the IDL object definition</p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>