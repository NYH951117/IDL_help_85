<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Bridges|COM Export Bridge|Examples">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>COM IDLitWindow Surface Manipulation</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../Bridges.htm">Bridges</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbsSelf">COM Export Bridge</span><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbsSelf">Examples</span><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">COM IDLitWindow Surface Manipulation</span>
        </div>
        <h1><a name="COM_IDLitWindow_Surface_Manipulation"></a>COM IDLitWindow Surface Manipulation</h1>
        <p>This drawable object <a name="kanchor5184"></a>example inherits from IDLitWindow and creates an ISURFACE display in a COM control. A listbox in a Visual Basic .NET Windows application is populated with manipulator string values that, when selected, allow you to draw annotations, rotate, or zoom within the exported IDLitWindow control. You should avoid exposing any manipulator that has an associated widget interface (such as a profile line manipulator) since such widget functionality is not supported in objects that subclass from IDLitWindow.</p>
        <h2>Example Code</h2>
        <p>The object definition file,  <i>export_itwinmanip_doc define.pro</i> is located in the <i>examples/doc/bridges</i> subdirectory of the IDL distribution. Run the example procedure by entering <i>export_itwinmanip_doc</i> define at the IDL command prompt or view the file in an IDL Editor window by entering:</p>
        <p class="Code">.EDIT export_itwinmanip_doc define.pro</p>
        <p>Complete the following steps to duplicate this example:</p>
        <ol>
            <li value="1">In an IDL Editor window, open the object definition file by entering</li>
            <p class="Code">.EDIT export_itwinmanip_doc define.pro</p>
            <p>at the command prompt.</p>
            <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>It is a good idea to test the functionality of an object before exporting it. After compiling the file, enter the following lines at the command line and make sure the output is what is expected for this object.<br /><i>oWin = OBJ_NEW("export_itwinmanip_doc")</i><br style="font-style: italic;" /><i>oWin-&gt;CHANGEMANIPULATOR, "annotation/oval"</i><br />This will let you draw a oval annotation in the window. If you hit the Delete key, the annotation will be removed. The available manipulator strings are printed in the IDL output window.</p>
            <li value="2">Open the Export Bridge Assistant by entering IDLEXBR_ASSISTANT at the command line.</li>
            <li value="3">Select to create a COM export object by selecting <b>File &gt; New Project &gt; COM</b> and browse to select <i>export_itwinmanip_doc__define.pro</i>. Click <b>Open</b> to load the file into the Export Assistant.</li>
            <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>Export Bridge Assistant details are available in <a href="../ExportFromIDL - Export Bridge Assistant/SpecifyingInformationForExporting.htm#Specifying_Information_For_Exporting">Specifying Information for Exporting</a>. Refer to that section if you need more information about the following items.</p>
            <li value="4">Set export object characteristics as described in the following table. When you select the tree view item listed in the left column, configure the related properties as noted in the right column.</li>
            <table style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/Description.css');" class="TableStyle_Description" cellspacing="0">
                <col />
                <col />
                <thead>
                    <tr>
                        <th class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                            <p>Tree View Item</p>
                        </th>
                        <th class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                            <p>Property Configuration</p>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                            <p>IDL Export Bridge Project</p>
                        </td>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                            <p>	Accept the default value or make changes as desired:</p>
                            <ul>
                                <li value="1">Output classname</li>
                                <li value="2">Process name</li>
                                <li value="3">Output directory</li>
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                            <p>export_itwinmanip_doc</p>
                        </td>
                        <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                            <p>Drawable object equals True</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                            <p>CHANGEMANIPULATOR method</p>
                        </td>
                        <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                            <p>Enter different name if desired and mark <b>Export</b> as True</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
                            <p>MANIPID argument</p>
                        </td>
                        <td class="TableStyle_Description_Body_1_0_RowEnd_ColEnd">
                            <p><b>Mutability</b> — In</p>
                            <p><b>Type</b> — BSTR</p>
                            <p><b>Array</b> — False</p>
                            <p><b>Export</b> — True</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <li value="5">Save the project by selecting <b>File &gt; Save project</b>. Accept the default name and location or make changes as desired.</li>
            <li value="6">Verify that the object elements you want to export are listed in the Export log panel. If the expected items are not present, one or more items may still have an UNSPECIFIED field value that must be changed.</li>
            <li value="7">Build the export object by selecting <b>Build &gt; Build object</b>. The <b>Build log</b> panel shows the results of the build process. For a drawable object, <i>.tlb</i> and <i>.ocx</i> files (named based on the object name) are created in the <b>Output directory</b>.</li>
            <li value="8">Register the <i>.ocx</i> using <i>regsvr32 export_itwinmanip_doc.ocx</i>. See <a href="../ExportFromIDL - IDL Objects/ConfiguringBuildAndClientMachines.htm#COM_Registration_Requirements">COM Registration Requirements</a> for details if needed.</li>
            <li value="9">Create a new Visual Basic .NET Windows Application and add the <i>export_itwinmanip_doc</i> Class file to the toolbox. Select <b>View &gt; Toolbox</b> and select the desired tab. Right-click and select <b>Add/Remove Items</b>. Select the <b>COM Components</b> tab, place a checkmark next to the class file, and click <b>OK</b>.</li>
            <li value="10">Add the IDL <i>export_itwinmanip_doc</i> control to your form.</li>
            <li value="11">Replace the default form code with the text in the file referenced below. See code comments for details.</li>
        </ol>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>The text file for this example, <i>com_export_itwinmanip_doc.txt</i>, is located in the <i>examples/doc/bridges/COM</i> subdirectory of the IDL distribution. This Visual Basic .NET code can be copied from the text file and adopted for use in your COM environment.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>This example exposes keyboard events. The value of the <b>Delete</b> key and other standard keys are described in <a href="EventHandling.htm#Mouse_and_Keyboard_Events_in_COM_Export_Objects">Mouse and Keyboard Events in COM Export Objects</a>.</p>
        <p>Build and run the project. Select a manipulator from the listbox to use it in the IDLitWindow display. If you hit the keyboard <b>Delete</b> key while visualizations are selected, they will be removed from the view.</p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>