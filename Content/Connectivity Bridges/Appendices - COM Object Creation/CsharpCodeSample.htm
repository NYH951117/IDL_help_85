<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Bridges|COM Export Bridge|COM Object Creation">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>C# Code Sample</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../Bridges.htm">Bridges</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbsSelf">COM Export Bridge</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="COMObjectCreation.htm">COM Object Creation</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">C# Code Sample</span>
        </div>
        <h1><a name="C#_Code_Sample"></a><a name="kanchor5126"></a>C# <a name="kanchor5127"></a>Code <a name="kanchor5128"></a>Sample</h1>
        <p>Within Visual Studio .NET, in the Solution Explorer window, underneath the project that will use the wrapper object, right-click on the <b>References</b> item, then select <b>Add Reference…</b>. This brings up a dialog. Select the <b>COM</b> tab, then <b>Browse</b>, and change the path to the wrapper <i>.dll</i>. This imports the object reference into the project.</p>
        <p>Then, within the project that will use the wrapper object, include the following line at the top, outside of the namespace for the class:</p>
        <p class="Code">using IDLexFooLib;</p>
        <h2><a name="kanchor5129"></a>Initiation Without Parameters in C#</h2>
        <p>Use the following code to initialize the object with no parameters.</p>
        <p class="Code">private void button1_Click(...)</p>
        <p class="Code">{</p>
        <p class="Code_Indented">IDLexFooClass oFoo = new IDLexFooClass();</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">try</p>
        <p class="Code_Indented">{</p>
        <p class="Code_Indented" style="text-indent: 20px;">oFoo.CreateObject(0, 0, 0);</p>
        <p class="Code_Indented">}</p>
        <p class="Code_Indented" style="text-indent: 0px;">catch</p>
        <p class="Code_Indented" style="text-indent: 0px;">{</p>
        <p class="Code_Indented" style="text-indent: 20px;">Debug.WriteLine(oFoo.GetLastError());</p>
        <p class="Code_Indented" style="text-indent: 20px;">return;</p>
        <p class="Code_Indented">}</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">// Use object here...</p>
        <p class="Code">}</p>
        <h2><a name="kanchor5130"></a>Initiation with Parameters in C#</h2>
        <p>Use the following code to initialize the object with its three parameters (a string, a 32-bit long value, and an array that has two rows and three columns, containing 32- bit long values).</p>
        <p class="Code">private void button1_Click(...)</p>
        <p class="Code">{</p>
        <p class="Code_Indented">const int PARMFLAG_CONST	= 0x0001;</p>
        <p class="Code_Indented">const int PARMFLAG_CONV_MAJORITY = 0x4000;</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">IDLexFooClass oFoo = new IDLexFooClass();</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">string	parmStr = "I am a string parameter";</p>
        <p class="Code_Indented">int	parmVal = 24;</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">int[,]	parmArr = {{10, 11, 12}, {20, 21, 22}};</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">int	argc = 3;</p>
        <p class="Code_Indented">object[] argval = {parmStr, parmVal, parmArr};</p>
        <p class="Code_Indented">int[]	argpal = {PARMFLAG_CONST, PARMFLAG_CONST, PARMFLAG_CONST | PARMFLAG_CONV_MAJORITY};</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">try</p>
        <p class="Code_Indented">{</p>
        <p class="Code_Indented" style="text-indent: 20px;">oFoo.CreateObject(argc, argval, argpal);</p>
        <p class="Code_Indented">}</p>
        <p class="Code_Indented">catch</p>
        <p class="Code_Indented">{</p>
        <p class="Code_Indented" style="text-indent: 20px;">Debug.WriteLine(oFoo.GetLastError());</p>
        <p class="Code_Indented" style="text-indent: 20px;">return;</p>
        <p class="Code_Indented">}</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">// Use object here...</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code">}</p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>