<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Additional Topics">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>ENVI Extension Wizard</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../OtherTopics.htm">Additional Topics</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">ENVI Extension Wizard</span>
        </div>
        <h1>ENVI Extension Wizard</h1>
        <p>The ENVI Extension <a name="kanchor4412"></a>Wizard allows you to create an IDL project to be used as a custom ENVI extension. Custom ENVI extensions appear in the Toolbox within the ENVI application.</p>
        <p>The steps necessary to build an ENVI extension are:</p>
        <ol>
            <li value="1">Use the ENVI Extension Wizard to create an IDL project, along with a corresponding IDL <code>.pro</code> file containing the extension template code.</li>
            <li value="2">Edit the extension code to perform your desired actions when the extension is invoked. See the <b>ENVI Help</b> topic <i>Writing and Deploying Toolbox Extensions</i> for details.</li>
            <li value="3">Using either the <b>Project</b> menu, or the context menu in the <b>Project Explorer</b>, choose <b>Build Project</b>. This will compile all of the required IDL code, and create an IDL SAVE file in the chosen extension directory. See <a href="ProjectBuildConcepts.htm">Building IDL Projects</a> for more information.</li>
            <li value="4">Start up the ENVI application. Your new extension should appear in the Toolbox. Double-click your extension to execute your code.</li>
        </ol>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If you have already run ENVI in the same session, you should  execute a <code>.RESET_SESSION</code> command before restarting ENVI, to ensure that your new extension is loaded.</p>
        <h2>ENVI Extension Wizard Dialog</h2>
        <p>To display the <b>ENVI Extension Wizard</b>, either select <b>File</b>-&gt;<b>New ENVI Extension</b>, or right-click in the <b>Project Explorer</b> and select <b>New ENVI Extension</b> from the context menu. The following fields are displayed in the wizard:</p>
        <h3>Project Name</h3>
        <p>The name of the IDL project that will contain the new extension. This project name must be unique. See <a href="Projects.htm">Projects</a> for details.</p>
        <h3>Extension Name</h3>
        <p>The human-readable name of the extension. This is the name that will be displayed in the Extensions Toolbox within the ENVI application.</p>
        <h3>IDL Procedure</h3>
        <p>The name of the IDL procedure to run when the extension is executed. This needs to be a valid IDL procedure name. This will also be used as the name of the <code>.pro</code> file that gets created.</p>
        <h3>Extension Path</h3>
        <p>A string denoting the tree structure, under the Extensions folder, in which the Toolbox item will appear. If the Extension Path is empty, the item will be added directly to the end of the Extensions folder. Multiple subfolders may be specified by adding the '/' character between folder names (for example, "My Routines/Statistics"). If a folder does not currently exist, it will be created.</p>
        <h3>Save File Location</h3>
        <p>The location where the IDL SAVE file should be created when the project is built (see <a href="ProjectBuildConcepts.htm">Building IDL Projects</a>). The ENVI application looks in three locations for extensions:</p>
        <ul>
            <li value="1">The directory given by the ENVI_EXTENSIONS environment variable</li>
            <li value="2">The install directory, <i>Install_Dir</i>/products/enviextensions</li>
            <li value="3">The user's home directory, <i>user_home</i>/.idl/exelis/enviextensions</li>
        </ul>
        <p>If left empty, this field is set to the user's home directory. After the IDL project has been created, you can go to the <a href="IDLBuildProperties.htm">IDL Build Properties</a> page to modify the SAVE file location.</p>
        <h2>Customizing the ENVI Extension Code</h2>
        <p>After you run the ENVI Extension Wizard, a new IDL editor opens, containing the extension code. The extension name, IDL procedure name, and extension path are automatically added to the code.</p>
        <p>By default, the extension file contains an "<code>_extensions_init</code>" procedure at the top, followed by the actual extension procedure. The extension procedure has a section of generic error-handling code, and then a line of code to retrieve the current ENVI application object. Finally, you should insert your custom extension code near the bottom of the file, after the IDL comment block marked "<code>Insert your ENVI Extension code here...</code>".</p>
        <p>If you wish, you may modify the default extension template code that is inserted. To modify the template, open the <b>Preferences</b> dialog in the IDL Workbench. In the <b>Preferences</b> dialog, choose <b>IDL</b> &gt;<b>Templates</b>, and edit the <b>ENVIExtension</b> template to contain your desired code. The following custom variables are available:</p>
        <table class="TableStyle_Description" style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/Description.css');" cellspacing="0">
            <col />
            <col />
            <thead>
                <tr>
                    <th class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Variable</p>
                    </th>
                    <th class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                        <p>Description</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>${EXTENSION_NAME}</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>The <i>ENVI Extension</i> name from the Wizard</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>${PROCEDURE_NAME}</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>The <i>IDL Procedure</i> name from the Wizard</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep" valign="top">
                        <p>${EXTENSION_PATH}</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd" valign="top">
                        <p>The <i>Extension Path</i> value from the Wizard</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>In addition, you can also use any of the other IDL template variables, such as ${date}, ${time}, ${user}, or ${year}.</p>
        <p>The extension can also accept an <code>event</code> argument that contains the UVALUE set during the call to ENVI::AddExtension. </p>
        <div class="mp_footer">Â© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>