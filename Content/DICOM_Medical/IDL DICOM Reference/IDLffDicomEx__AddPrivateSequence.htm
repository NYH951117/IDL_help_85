<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Additional Topics|Medical Imaging in IDL|IDL DICOM Reference|IDLffDicomEx">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>IDLffDicomEx::AddPrivateSequence
        </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><a class="MCBreadcrumbsLink" href="../../OtherTopics.htm">Additional Topics</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Expanded DICOM Support in IDL/ExpandedDICOMFunctionality.htm">Medical Imaging in IDL</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="DICOMEX_GETCONFIGFILEPAT.htm">IDL DICOM Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">IDLffDicomEx::AddPrivateSequence</span>
        </div>
        <h1 class="ObjMethod">IDLffDicomEx::AddPrivateSequence
        </h1>
        <p>The IDLffDicomEx::AddPrivateSequence function method creates a new private sequence. When calling AddPrivateSequence the PrivateCode, Group, and Element arguments identify the characteristics and placement of the private sequence.</p>
        <p>The optional PARENTSEQID keyword can be used to create a nested sequence, placing the new private sequence within an existing sequence. This existing sequence is identified by a sequence identifier, which may have been returned by a previous call to <a href="#">IDLffDicomEx::AddPrivateSequence</a> or <a href="IDLffDicomEx__GetPrivateValue.htm">IDLffDicomEx::GetPrivateValue</a>. Once the sequence has been created, member items can be added via the IDLffDicomEx::SetPrivateValue method using the return value from this method, the identifier of the new sequence.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>The new sequence is not written to the DICOM file until you call the <a href="IDLffDicomEx__Commit.htm">IDLffDicomEx::Commit</a> method. When you commit changes, the sequence identifier is invalidated. You need to call <a href="IDLffDicomEx__GetPrivateValue.htm">IDLffDicomEx::GetPrivateValue</a> to re-access the sequence identifier. </p>
        <h2 class="API"><a name="dicom_ex_4010397576_1006833"></a><a name="dicom_ex_4010397576_1006833_PageTOC_IDLffDicomEx"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = <i>Obj</i>-&gt;[<a href="IDLffDicomEx.htm">IDLffDicomEx</a>::]AddPrivateSequence (<i>PrivateCode, Group, Element </i>[,&#160;<a href="#dicom_ex_4010397576_1006855" class="selected">PARENTSEQID</a>=<i>integer</i>]&#160;)</p>
        <h2 class="API"><a name="dicom_ex_4010397576_1006835"></a><a name="dicom_ex_4010397576_1006835_PageTOC_IDLffDicomEx"></a>Return Value</h2>
        <p>Returns a long integer containing the sequence identifier for the newly created sequence. This identifier can be used by other methods that use the SEQID keyword such as <a href="IDLffDicomEx__GetPrivateValue.htm"> IDLffDicomEx::GetPrivateValue</a> and <a href="IDLffDicomEx__SetPrivateValue.htm">IDLffDicomEx::SetPrivateValue</a> methods.</p>
        <h2 class="API"><a name="dicom_ex_4010397576_1006843"></a><a name="dicom_ex_4010397576_1006843_PageTOC_IDLffDicomEx"></a>Arguments</h2>
        <h3 class="Argument">PrivateCode</h3>
        <p>A string identification code that identifies the private block of data. Within a given private group <i>PrivateCode</i> labels are stored sequentially in the element addresses ranging from '0010' to '00FF'. For example, the string value stored at DICOM tag address '0029,0010' is the <i>PrivateCode</i> for the block of data tagged at '0029,1000'&#160;&#8209;&#160;'0029,10FF'. The label stored at '0029,0011' would be the <i>PrivateCode</i> for the data in tags '0029,1100' - '0029,11 FF'.</p>
        <h3 class="Argument">Group</h3>
        <p>A string identifying the group tag number of the private attribute (the first four digits of a DICOM tag). This must be an odd number and in the form 'XXXX'. If this does not reference an existing sequence, then a new private sequence is created. </p>
        <h3 class="Argument">Element</h3>
        <p>A string identifying the last two digits of the element associated with the private attribute. This must be in the form 'XX'. Valid values are 10 - FF. </p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>The first two digits of the <i>Element</i> are implicit in the <i>PrivateCode</i> argument. </p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If the <i>PrivateCode</i> differs, but the <i>Group</i>, <i>Element</i> combination of arguments already exists, the <i>Element</i> value will be internally incremented to avoid overwriting the existing sequence. To modify existing sequences, use the <a href="IDLffDicomEx__SetPrivateValue.htm">IDLffDicomEx::SetPrivateValue
        </a> method. </p>
        <h2 class="API"><a name="dicom_ex_4010397576_1006854"></a><a name="dicom_ex_4010397576_1006854_PageTOC_IDLffDicomEx"></a>Keywords</h2>
        <h3 class="Keyword"><a name="dicom_ex_4010397576_1006855"></a><a name="dicom_ex_4010397576_1006855_Keywords_IDLffDicomEx"></a>PARENTSEQID</h3>
        <p>Set this keyword only if adding the new sequence to an existing sequence. Use this keyword to specify a parent sequence as follows:</p>
        <ul>
            <li value="1">If set to a non-zero value, then the sequence will be added as a member item to the private sequence associated with this parent sequence identifier. This sequence identifier may have been returned via a previous call to the IDLffDicomEx::AddPrivateSequence method. </li>
            <li value="2">If set to 0 or not specified, then the sequence is added to a private sequence at the root level of the DICOM file. This is the default value.</li>
        </ul>
        <h2 class="API"><a name="dicom_ex_4010397576_1034572"></a><a name="dicom_ex_4010397576_1034572_PageTOC_IDLffDicomEx"></a>Example</h2>
        <p>The following example adds a private attribute to the root level of the DICOM file, a private sequence, and two items in the private sequence. This example shows how to add private attributes, but does not write the tags to the cloned file. The new private attributes are printed to the Output Log window. </p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>This example does not write the cloned file to memory. To do so, simply use the <a href="IDLffDicomEx__Commit.htm"> IDLffDicomEx::Commit</a> method. </p>
        <p class="Code">PRO dicom_setprivate_doc</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Select a DICOM file.</p>
        <p class="Code">sFile = DIALOG_PICKFILE($</p>
        <p class="Code">    PATH=FILEPATH('',SUBDIRECTORY=['examples','data']), $</p>
        <p class="Code">    TITLE='Select DICOM Patient File', FILTER='*.dcm', $</p>
        <p class="Code">    GET_PATH=path)</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Create a clone (aImgClone.dcm) of the selected file (sfile).</p>
        <p class="Code"> oImg = OBJ_NEW('IDLffDicomEx', path + 'aImgClone.dcm', $</p>
        <p class="Code">    CLONE=sfile)</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Add private tags. The following are hypothetical.</p>
        <p class="Code">; Create a multi-valued tag at the root level.</p>
        <p class="Code">arr = [1, 2, 3, 4]</p>
        <p class="Code">oImg-&gt;SetPrivateValue, 'Private Test', '0053', '10', 'SS', arr</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Create a sequence at the root level.</p>
        <p class="Code">vSeqId = oImg-&gt;AddPrivateSequence('VOI Min,Max', '0055', '12')</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Add items to the sequence, specifying the sequence identifier </p>
        <p class="Code">; returned by AddPrivateSequence.</p>
        <p class="Code">oImg-&gt;SetPrivateValue, 'VOI Min,Max', '0055', '13', 'IS', '215', $</p>
        <p class="Code">   SEQID=vSeqID</p>
        <p class="Code">oImg-&gt;SetPrivateValue, 'VOI Min,Max', '0055', '14', 'IS', '234', $</p>
        <p class="Code">   SEQID=vSeqID</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Print a range including the new tags to</p>
        <p class="Code">; the Output Log window.</p>
        <p class="Code">vTags = oImg-&gt;EnumerateTags(COUNT=vTagCnt, $</p>
        <p class="Code">   START_TAG='0053,0000', STOP_TAG='0057,0000')</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Format the output.</p>
        <p class="Code">PRINT, FORMAT= $</p>
        <p class="Code">   '(%"%3s, %2s, %12s, %3s, %12s, %20s")', $</p>
        <p class="Code">   'IDX', 'LVL', 'TAG',  'VR', 'DESCRIPTION', 'VALUE'</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Cycle through the tags.</p>
        <p class="Code">FOR xx = 0, vTagCnt-1  DO BEGIN</p>
        <p class="Code">&#160;</p>
        <p class="Code">   ; If the item is nested within another item, indicate the</p>
        <p class="Code">   ; level using &gt; symbol.</p>
        <p class="Code">    IF (vTags[xx].Level GT 0) THEN BEGIN</p>
        <p class="Code">&#160;&#160;&#160;&#160;&#160;&#160;vLvl = STRJOIN(REPLICATE('&gt;',vTags[xx].Level))</p>
        <p class="Code">      vtg =  vLvl + vTags[xx].Tag</p>
        <p class="Code">    ENDIF ELSE BEGIN</p>
        <p class="Code">      vtg = vTags[xx].Tag</p>
        <p class="Code">    ENDELSE</p>
        <p class="Code">&#160;</p>
        <p class="Code">    ; If the tags are in a group, indicate this.</p>
        <p class="Code">    IF (vTags[xx].GroupNum GT 0) THEN BEGIN</p>
        <p class="Code">       PRINT, FORMAT='(%"%15s, %1d")', 'Group', vTags[xx].GroupNum</p>
        <p class="Code">    ENDIF</p>
        <p class="Code">&#160;</p>
        <p class="Code">   ; Print the fields of the structure.</p>
        <p class="Code">   PRINT, FORMAT = $</p>
        <p class="Code">      '(%"%3d, %2d, %-12s, %3s, %12s, %20s")', $</p>
        <p class="Code">       xx, vTags[xx].Level, vtg, vTags[xx].VR, $</p>
        <p class="Code">       vTags[xx].Description, vTags[xx].Value</p>
        <p class="Code">&#160;</p>
        <p class="Code">ENDFOR</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Clean up references.</p>
        <p class="Code">OBJ_DESTROY, oImg</p>
        <p class="Code">&#160;</p>
        <p class="Code">END</p>
        <p>This example creates the following output.</p>
        <p class="Code">IDX, LV,          TAG,  VR,  DESCRIPTION,                VALUE</p>
        <p class="Code">  0,  0, 0053,0010   ,  LO,             ,         Private Test</p>
        <p class="Code">  1,  0, 0053,1010   ,  SS,             ,              1\2\3\4</p>
        <p class="Code">  2,  0, 0055,0010   ,  LO,             ,          VOI Min,Max</p>
        <p class="Code">  3,  0, 0055,1012   ,  SQ,             ,                     </p>
        <p class="Code">  4,  1, &gt;0055,0010  ,  LO,             ,          VOI Min,Max</p>
        <p class="Code">  5,  1, &gt;0055,1013  ,  IS,             ,                  215</p>
        <p class="Code">  6,  1, &gt;0055,1014  ,  IS,             ,                  234</p>
        <h2 class="API"><a name="dicom_ex_4010397576_1068020"></a><a name="dicom_ex_4010397576_1068020_PageTOC_IDLffDicomEx"></a>Version History</h2>
        <table style="mc-table-style: url('../../Resources/TableStyles/VersionTable.css');margin-left: 0;margin-right: auto;caption-side: top;" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>6.1</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="mp_footer">Â© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>