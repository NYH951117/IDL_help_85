<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Additional Topics|Medical Imaging in IDL|IDL DICOM Reference|IDLffDicomEx">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>IDLffDicomEx::GetValueCount
</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><a class="MCBreadcrumbsLink" href="../../OtherTopics.htm">Additional Topics</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Expanded DICOM Support in IDL/ExpandedDICOMFunctionality.htm">Medical Imaging in IDL</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="DICOMEX_GETCONFIGFILEPAT.htm">IDL DICOM Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">IDLffDicomEx::GetValueCount</span>
        </div>
        <h1 class="ObjMethod">IDLffDicomEx::GetValueCount
</h1>
        <p>The IDLffDicomEx::GetValueCount function method returns the number of values in a DICOM attribute specified by a standard DICOM attribute tag. This method allows you to return the number of values contained in public attributes. See <a href="IDLffDicomEx__GetPrivateValueCount.htm">IDLffDicomEx::GetPrivateValueCount</a> for information on returning the number of values within a private attribute.        </p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>GetValueCount will fail if you attempt to return a value for an attribute that does not exist or an attribute that has been removed. If you are not sure if an attribute exists use <a href="IDLffDicomEx__QueryValue.htm#dicom_ex_4010397576_1008324">IDLffDicomEx::QueryValue</a> before calling GetValueCount.</p>
        <h2 class="API"><a name="dicom_ex_4010397576_1007758"></a><a name="dicom_ex_4010397576_1007758_PageTOC_IDLffDicomEx"></a>Syntax</h2>
        <p class="Syntax"><i>Result = Obj</i>-&gt;[<a href="IDLffDicomEx.htm">IDLffDicomEx</a>::]GetValueCount(<i>DicomTag</i> [,&#160;<a href="#dicom_ex_4010397576_1007772" class="selected">SEQID</a>=<i>integer</i>]&#160;) </p>
        <h2 class="API"><a name="dicom_ex_4010397576_1007760"></a><a name="dicom_ex_4010397576_1007760_PageTOC_IDLffDicomEx"></a>Return Value</h2>
        <p>Returns an unsigned long value indicating the number of values in the value field of the specified attribute as follows:</p>
        <ul>
            <li value="1">A value of 0 indicates the tag had no value</li>
            <li value="2">A value greater than 0 (<i>n</i>) indicates the number of values in the value field</li>
        </ul>
        <h2 class="API"><a name="dicom_ex_4010397576_1076430"></a><a name="dicom_ex_4010397576_1076430_PageTOC_IDLffDicomEx"></a>Arguments</h2>
        <h3 class="Argument">DicomTag</h3>
        <p>A string that identifies the group and element of a DICOM attribute in the form <code>'XXXX,XXXX'</code>. The <i>DicomTag</i> argument must reference a public tag. See <a href="../DICOM Resources/DICOMAttributes.htm">DICOM Attributes</a> for a list of tags.</p>
        <h2 class="API"><a name="dicom_ex_4010397576_1007771"></a><a name="dicom_ex_4010397576_1007771_PageTOC_IDLffDicomEx"></a>Keywords</h2>
        <h3 class="Keyword"><a name="dicom_ex_4010397576_1007772"></a><a name="dicom_ex_4010397576_31167"></a>SEQID</h3>
        <p>Set this keyword only if retrieving the value of an attribute that exists within a sequence. Use this keyword to specify sequence identifier as follows:</p>
        <ul>
            <li value="1">Set to a non-zero value (a sequence identifier) indicating the sequence in which the value is contained. This sequence identifier may have been returned via a previous call to the GetValue method. </li>
            <li value="2">Set to 0 or do not specify this keyword to indicate the attribute exists at the root level of the DICOM file. This is the default. </li>
        </ul>
        <h2 class="API"><a name="dicom_ex_4010397576_1007778"></a><a name="dicom_ex_4010397576_1007778_PageTOC_IDLffDicomEx"></a>Example</h2>
        <p>The following example returns the number of items in a multi-valued Image Type attribute (0008,0008) and uses this value to cycle through the collection of values. For more information on the attribute, see <a href="IDLffDicomEx.htm#dicom_ex_4010397576_1025493">IMAGE_TYPE</a>. </p>
        <p class="Code">PRO read_count_imagetypeattr</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Select a DICOM file to examine.</p>
        <p class="Code">sFile = DIALOG_PICKFILE( $</p>
        <p class="Code">    PATH=FILEPATH('',SUBDIRECTORY=['examples','data']), $</p>
        <p class="Code">    TITLE='Select DICOM Patient File', FILTER='*.dcm')</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Open the selected file in read-only mode.</p>
        <p class="Code"> oImg = OBJ_NEW('IDLffDicomEx', sfile)</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Return the Image Type attribute count that can have</p>
        <p class="Code">; 1 to n values. And then return the value of the tag.</p>
        <p class="Code">vCount = oImg-&gt;GetValueCount('0008,0008')</p>
        <p class="Code">result = oImg-&gt;GetValue('0008,0008')</p>
        <p class="Code">&#160;</p>
        <p class="Code">FOR i = 1, vCount DO BEGIN</p>
        <p class="Code">   Print, 'Result number', i, + ' is ', result[i-1]</p>
        <p class="Code">ENDFOR</p>
        <p class="Code">&#160;</p>
        <p class="Code">END</p>
        <p>For example, when you select <code>us_test.dcm</code>, the following is printed to the Output Log window:</p>
        <p class="Code">Result number       1 is ORIGINAL</p>
        <p class="Code">Result number       2 is PRIMARY</p>
        <p class="Code">Result number       3 is EPICARDIAL</p>
        <h2 class="API"><a name="dicom_ex_4010397576_1036958"></a><a name="dicom_ex_4010397576_1036958_PageTOC_IDLffDicomEx"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>6.1</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="mp_footer">Â© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>