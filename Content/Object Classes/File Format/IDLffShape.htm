<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Object Classes|File Format Object Classes">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>IDLffShape</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../ObjectClasses.htm">Object Classes</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="objects_ff.htm">File Format Object Classes</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">IDLffShape</span>
        </div>
        <h1 class="ObjClass"><a name="objects_ff_3755668711_1006985"></a><a name="kanchor3243"></a>IDLffShape</h1>
        <p data-mc-conditions="Reference Material.Online_Help_Only">
            <MadCap:conditionalText data-mc-conditions="Reference Material.Online_Help_Only"><a href="#objects_ff_3755668711_1007009" class="selected">Superclasses</a> | <a href="#objects_ff_3755668711_1007012" class="selected">Creation</a> | <a href="#objects_ff_3755668711_1026977" class="selected">Properties</a> | <a href="#objects_ff_3755668711_1007018" class="selected">Methods</a> | <a href="#objects_ff_3755668711_1007066" class="selected">Version History</a> | <a href="#objects_ff_3755668711_1007069" class="selected">Overview of ESRI Shapefiles</a> | <a href="#objects_ff_3755668711_1473032" class="selected">Examples</a></MadCap:conditionalText>
        </p>
        <p>An <a name="kanchor3244"></a>IDLffShape object contains geometry, connectivity and attributes for graphics primitives accessed from ESRI Shapefiles. See <a href="#objects_ff_3755668711_1007069" class="selected">Overview of ESRI Shapefiles</a>.</p>
        <h2 class="API"><a name="objects_ff_3755668711_1007009"></a>Superclasses</h2>
        <p>None</p>
        <h2 class="API"><a name="objects_ff_3755668711_1007012"></a>Creation</h2>
        <p>See <a href="IDLffShape__Init.htm#objects_ff_3755668711_1008047">IDLffShape::Init</a></p>
        <h2 class="API"><a name="objects_ff_3755668711_1026977"></a>Properties</h2>
        <p>Objects of this class have the following properties. See <a href="IDLffShape_Properties.htm#objects_ff_3755668711_1026998">IDLffShape Properties</a> for details on individual properties.</p>
        <ul>
            <li value="1"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027034">ATTRIBUTE_INFO</a>
            </li>
            <li value="2"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027309">ATTRIBUTE_NAMES</a>
            </li>
            <li value="3"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027319">DBF_ONLY</a>
            </li>
            <li value="4"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027088">ENTITY_TYPE</a>
            </li>
            <li value="5"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027353">FILENAME</a>
            </li>
            <li value="6"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027563">IS_OPEN</a>
            </li>
            <li value="7"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027361">N_ATTRIBUTES</a>
            </li>
            <li value="8"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027330">N_ENTITIES</a>
            </li>
            <li value="9"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027328">N_RECORDS</a>
            </li>
            <li value="10"><a href="IDLffShape_Properties.htm#objects_ff_3755668711_1027071">UPDATE</a>
            </li>
            <li value="11"><a name="objects_ff_3755668711_1007018"></a>Methods<a name="kanchor3245"></a></li>
        </ul>
        <p>This class has the following methods:</p>
        <ul>
            <li value="1"><a href="IDLffShape__AddAttribute.htm#objects_ff_3755668711_1007497">IDLffShape::AddAttribute</a>
            </li>
            <li value="2"><a href="IDLffShape__Cleanup.htm#objects_ff_3755668711_1007607">IDLffShape::Cleanup</a>
            </li>
            <li value="3"><a href="IDLffShape__Close.htm#objects_ff_3755668711_1007644">IDLffShape::Close</a>
            </li>
            <li value="4"><a href="IDLffShape__DestroyEntit.htm#objects_ff_3755668711_1007681">IDLffShape::DestroyEntity</a>
            </li>
            <li value="5"><a href="IDLffShape__GetAttribute.htm#objects_ff_3755668711_1007744">IDLffShape::GetAttributes</a>
            </li>
            <li value="6"><a href="IDLffShape__GetEntity.htm#objects_ff_3755668711_1007808">IDLffShape::GetEntity</a>
            </li>
            <li value="7"><a href="IDLffShape__GetProperty.htm#objects_ff_3755668711_1007887">IDLffShape::GetProperty</a>
            </li>
            <li value="8"><a href="IDLffShape__Init.htm#objects_ff_3755668711_1008047">IDLffShape::Init</a>
            </li>
            <li value="9"><a href="IDLffShape__Open.htm#objects_ff_3755668711_1008112">IDLffShape::Open</a>
            </li>
            <li value="10"><a href="IDLffShape__PutEntity.htm#objects_ff_3755668711_1008171">IDLffShape::PutEntity</a>
            </li>
            <li value="11"><a href="IDLffShape__SetAttribute.htm#objects_ff_3755668711_1008252">IDLffShape::SetAttributes</a>
            </li>
        </ul>
        <h2 class="API"><a name="objects_ff_3755668711_1007066"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_ColSep">
                        <p>5.4</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>5.6</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Added N_RECORDS, DBF_ONLY properties </p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="objects_ff_3755668711_1007069"></a>Overview of ESRI Shapefiles</h2>
        <p>An ESRI <a name="kanchor3246"></a>Shapefile stores nontopological geometry and attribute information for the spatial features in a data set.</p>
        <p>A Shapefile consists of a main file (<code>.shp</code>), an index file (<code>.shx</code>), and a dBASE table (<code>.dbf</code>). For example, the Shapefile “states” would have the following files:</p>
        <ul>
            <li value="1">states.shp</li>
            <li value="2">states.shx</li>
            <li value="3">states.dbf</li>
        </ul>
        <h3>Naming Conventions for a <a name="kanchor3247"></a>Shapefile</h3>
        <p>All the files that comprise an ESRI Shapefile must adhere to the 8.3 filename convention and must be lower case. The main file, index file, and dBASE file must all have the same prefix. The prefix must start with an alphanumeric character and can contain any alphanumeric, underscore (_), or hyphen (-). The main file suffix must use the <code>.shp</code> extension, the index file the <code>.shx</code> extension, and the dBASE table the <code>.dbf</code> extension.</p>
        <h3><a name="objects_ff_3755668711_22383"></a>Major Elements of a Shapefile</h3>
        <p>A Shapefile consists of the following elements that you can access through the IDLffShape class:</p>
        <ul>
            <li value="1">Entities</li>
            <li value="2">Attributes</li>
        </ul>
        <h4><a name="objects_ff_3755668711_1007085"></a>Entities</h4>
        <p>The <a name="kanchor3248"></a>geometry for a f<a name="kanchor3249"></a>eature is stored as a shape comprising a set of vector coordinates (referred to as ‘entities’). The (non-null) entities in a Shapefile must all be of the same type. The following are the possible types for entities in a Shapefile:</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/Description.css');margin-left: 0;margin-right: auto;caption-side: bottom;" cellspacing="0" class="TableStyle_Description">
            <col />
            <col />
            <thead>
                <tr>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Shape Type</p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                        <p>Type Code</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Point</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>1</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>PolyLine</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>3</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Polygon</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>5</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>MultiPoint</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>8</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>PointZ</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>11</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>PolyLineZ</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>13</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>PolygonZ</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>15</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>MultiPointZ</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>18</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>PointM</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>21</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>PolyLineM</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>23</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>PolygonM</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>25</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>MultiPointM</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>28</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>MultiPatch</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd">
                        <p>31</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>When retrieving entities using the <a href="IDLffShape__GetEntity.htm#objects_ff_3755668711_1007808">IDLffShape::GetEntity</a> method, an IDL structure is returned. This <a name="kanchor3250"></a>structure has the following fields:</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/Description.css');margin-left: 0;margin-right: auto;caption-side: bottom;" cellspacing="0" class="TableStyle_Description">
            <col />
            <col />
            <col />
            <thead>
                <tr>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Field</p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Data Type</p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                        <p>Description</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>SHAPE_TYPE</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Long integer</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>The entity type.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>ISHAPE</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>Long integer</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>A read-only field containing the index of the specific entity within the shape object. This value is set automatically when the shape file is written.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>BOUNDS</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Eight-element, double-precision array</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>A bounding box that specifies the range limits of the entity. This eight element array contains the following information:</p>
                        <p>Index 0 — X minimum value</p>
                        <p>Index 1 — Y minimum value</p>
                        <p>Index 2 — Z minimum value (if Z is supported by type)</p>
                        <p>Index 3 — Measure minimum value (if measure is supported by entity type)</p>
                        <p>Index4 — X maximum value</p>
                        <p>Index5 — Y maximum value</p>
                        <p>Index6 — Z maximum value (if Z is supported by the entity type)</p>
                        <p>Index7 — Measure maximum value (if measure is supported by entity type)</p>
                        <p>If the entity is a point type, the values contained in the bounds array are also the values of the entity.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>N_VERTICES</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>Long integer</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>The number of vertices in the entity. If this value is one and the entity is a POINT type (POINT, POINTM, POINTZ), the vertices pointer will be set to NULL and the entity value will be maintained in the BOUNDS field.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>VERTICES</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Pointer to Vertices array</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>An IDL pointer that contains the vertices of the entity. This pointer contains a double array that has one of the following formats:</p>
                        <p>[2, <i>N</i>] - If Z data is not present</p>
                        <p>[3, <i>N</i>] - If Z data is present</p>
                        <p>where <i>N</i> is the number of vertices. These array formats can be passed to the polygon and polyline objects of IDL Object Graphics.</p>
                        <p>This pointer will be null if the entity is a point type, with the values maintained in the BOUNDS array.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>MEASURE</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>Pointer to Measure array</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>If the entity has a measure value (this is dependent on the entity type), this IDL pointer will contain a vector array of measure values. The length of this vector is N_VERTICES.</p>
                        <p>This pointer will be null if the entity is of type POINTM, with the values contained in the BOUNDS array.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>N_PARTS</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Long integer</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>If the values of the entity are separated into parts, the break points are enumerated in the parts array. This field lists the number of parts in this entity. If this value is 0, the entity is one part and the PARTS pointer will be NULL.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>PARTS</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>Pointer to Parts array</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>An IDL pointer that contains an array of indices into the vertex/measure arrays. These values represent the start of each part of the entity. The index range of each entity part is defined by the following:</p>
                        <p>Start = Parts[I]</p>
                        <p>End = Parts[I+1]-1 or the end of the array</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>PART_TYPES</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Pointer to part types</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>This IDL pointer is only valid for entities of type MultiPatch and defines the type of the particular part. If the entity type is not MultiPatch, part types are assumed to be type RING (SHPP_RING).</p>
                        <p>This pointer is NULL if the entity is not type MultiPatch.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
                        <p>ATTRIBUTES</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
                        <p>Pointer to Attribute array</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowEnd_ColEnd">
                        <p>If the attributes for an entity were requested, this field contains an IDL pointer that contains a structure of attributes for the entity. For more information on this structure, see <a href="#objects_ff_3755668711_1007284" class="selected">Attributes</a>.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h4><a name="objects_ff_3755668711_1007284"></a>Attributes</h4>
        <p>A <a name="kanchor3251"></a>Shapefile <a name="kanchor3252"></a>provides the ability to associate information describing each entity (a geometric element) contained in the file. This descriptive information, called attributes, consists of a set of named data elements for each geometric entity contained in the file. The set of available attributes is the same for every entity contained in a Shapefile, with each entity having its own set of attribute values.</p>
        <p>An attribute consist of two components:</p>
        <ul>
            <li value="1">A name</li>
            <li value="2">A data value</li>
        </ul>
        <p>The name consists of an 11 character string that is used to identify the data value. The data value is not limited to any specific format.</p>
        <p>The two components that form an attribute are accessed differently using the shape object. To get the name of attributes for the specific file, the ATTRIBUTE_NAMES keyword to the <a href="IDLffShape__GetProperty.htm#objects_ff_3755668711_1007887">IDLffShape::GetProperty</a> method is used. This returns a string array that contains the names for the attributes defined for the file.</p>
        <p>To get the attribute values for an entity, the <a href="IDLffShape__GetAttribute.htm#objects_ff_3755668711_1007744">IDLffShape::GetAttributes</a> method is called or the ATTRIBUTES keyword of the <a href="IDLffShape__GetEntity.htm#objects_ff_3755668711_1007808">IDLffShape::GetEntity</a> method is set. In each case, the attribute values for the specified entity is returned as an anonymous IDL structure. The numeric order of the fields in the returned structure map to the numeric order of the attributes defined for the file. The actual format of the returned <a name="kanchor3253"></a>structure is:</p>
        <p class="indent">ATTRIBUTE_0 : VALUE,</p>
        <p class="indent">ATTRIBUTE_1 : VALUE,</p>
        <p class="indent">ATTRIBUTE_2 : VALUE,</p>
        <p class="indent">...</p>
        <p class="indent">ATTRIBUTE_&lt;N-1&gt; : VALUE</p>
        <p>To access the values in the returned structure, you can either hard code the structure field names or use the structure indexing feature of IDL.</p>
        <h2 data-mc-conditions="Reference Material.Online_Help_Only"><a name="objects_ff_3755668711_1473032"></a>
            <MadCap:conditionalText data-mc-conditions="Reference Material.Online_Help_Only">Examples</MadCap:conditionalText>
        </h2>
        <p data-mc-conditions="Reference Material.Online_Help_Only">
            <MadCap:conditionalText data-mc-conditions="Reference Material.Online_Help_Only">See the following sections for examples of:</MadCap:conditionalText>
        </p>
        <ul>
            <li value="1" data-mc-conditions="Reference Material.Online_Help_Only">
                <MadCap:conditionalText data-mc-conditions="Reference Material.Online_Help_Only"><a href="#objects_ff_3755668711_1007327" class="selected">Accessing Shapefiles</a>
                </MadCap:conditionalText>
            </li>
            <li value="2" data-mc-conditions="Reference Material.Online_Help_Only">
                <MadCap:conditionalText data-mc-conditions="Reference Material.Online_Help_Only"><a href="#objects_ff_3755668711_1007398" class="selected">Creating New Shapefiles</a>
                </MadCap:conditionalText>
            </li>
            <li value="3" data-mc-conditions="Reference Material.Online_Help_Only">
                <MadCap:conditionalText data-mc-conditions="Reference Material.Online_Help_Only"><a href="#objects_ff_3755668711_1360452" class="selected">Updating Existing Shapefiles</a>
                </MadCap:conditionalText>
            </li>
        </ul>
        <h2 class="API"><a name="objects_ff_3755668711_1007327"></a>Accessing Shapefiles</h2>
        <p>The following example shows how to access data in a Shapefile. This example sets up a map to display parts of a Shapefile, opens a Shapefile, reads the entities from the Shapefile, and then plots only the state of Colorado:</p>
        <p class="Code">PRO ex_shapefile</p>
        <p class="Code">&#160;</p>
        <p class="Code_Indented">DEVICE, RETAIN=2, DECOMPOSED=0</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">!P.BACKGROUND = 255</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Define a color table</p>
        <p class="Code_Indented">r = BYTARR(256) &amp; g = BYTARR(256) &amp; b = BYTARR(256)</p>
        <p class="Code_Indented">r[0] = 0 &amp; g[0] = 0 &amp; b[0] = 0 ;Definition of black</p>
        <p class="Code_Indented">r[1] = 100 &amp; g[1] = 100 &amp; b[1] = 255 ;Definition of blue</p>
        <p class="Code_Indented">r[2] = 0 &amp; g[2] = 255 &amp; b[2] = 0 ;Definition of green</p>
        <p class="Code_Indented">r[3] = 255 &amp; g[3] = 255 &amp; b[3] = 0 ;Definition of yellow</p>
        <p class="Code_Indented">r[255] = 255 &amp; g[255] = 255 &amp; b[255] = 255 ;Definition of white</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">TVLCT, r, g, b</p>
        <p class="Code_Indented">black = 0 &amp; blue = 1 &amp; green = 2 &amp; yellow = 3 &amp; white = 255</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Set up map to plot Shapefile on</p>
        <p class="Code_Indented">MAP_SET, /ORTHO, 45, -120, /ISOTROPIC, $</p>
        <p class="Code_Indented">&#160;&#160;&#160;/HORIZON, E_HORIZON={FILL:1, COLOR:blue}, $</p>
        <p class="Code_Indented">&#160;&#160;&#160;/GRID, COLOR=black, /NOBORDER</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Fill the continent boundaries:</p>
        <p class="Code_Indented">MAP_CONTINENTS, /FILL_CONTINENTS, COLOR=green</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Overplot coastline data:</p>
        <p class="Code_Indented">MAP_CONTINENTS, /COASTS, COLOR=black</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Show national borders:</p>
        <p class="Code_Indented">MAP_CONTINENTS, /COUNTRIES, COLOR=black</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Open the states Shapefile in the examples directory</p>
        <p class="Code_Indented">myshape = OBJ_NEW('IDLffShape', FILEPATH('states.shp', $</p>
        <p class="Code_Indented">&#160;&#160;&#160;SUBDIR=['examples', 'data']))</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Get the number of entities so we can parse through them</p>
        <p class="Code_Indented">myshape-&gt;GetProperty, N_ENTITIES=num_ent</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Parsing through the entities and only plotting the state of</p>
        <p class="Code_Indented">; Colorado</p>
        <p class="Code_Indented">FOR x=0L, (num_ent-1) DO BEGIN</p>
        <p class="Code_Indented">&#160;&#160;&#160;; Get the Attributes for entity x</p>
        <p class="Code_Indented">&#160;&#160;&#160;attr = myshape-&gt;GetAttributes(x)</p>
        <p class="Code_Indented">&#160;&#160;&#160;; See if 'Colorado' is in ATTRIBUTE_1 of the attributes for</p>
        <p class="Code_Indented">&#160;&#160;&#160;; entity x</p>
        <p class="Code_Indented">&#160;&#160;&#160;IF attr.ATTRIBUTE_1 EQ 'Colorado' THEN BEGIN</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;; Get entity</p>
        <p class="Code_Indented"> &#160;&#160;&#160;&#160;&#160;ent = myshape-&gt;GetEntity(x)</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;; Plot entity</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;POLYFILL, (*ent.VERTICES)[0, *], (*ent.VERTICES)[1, *], $</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;COLOR=yellow</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;; Clean-up of pointers</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;myshape-&gt;DestroyEntity, ent</p>
        <p class="Code_Indented">&#160;&#160;&#160;ENDIF</p>
        <p class="Code_Indented">ENDFOR</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Close the Shapefile</p>
        <p class="Code_Indented">OBJ_DESTROY, myshape</p>
        <p class="Code">&#160;</p>
        <p class="Code">END</p>
        <p>This results in the following:</p>
        <p>
            <img src="../../images/shp_ex1.gif" />
        </p>
        <h2 class="API"><a name="objects_ff_3755668711_1007398"></a>Creating New Shapefiles</h2>
        <p>To create a Shapefile, you need to create a new Shapefile object, define the entity and attributes definitions, and then add your data to the file. For example, the following program creates a new Shapefile (<code>cities.shp</code>), defines the entity type to be “Point”, defines 2 attributes (CITY_NAME and STATE_NAME), and then adds an entity to the new file:</p>
        <p class="Code">PRO ex_shapefile_newfile</p>
        <p class="Code">&#160;</p>
        <p class="Code_Indented">; Create the new shapefile and define the entity type to Point</p>
        <p class="Code_Indented">mynewshape = OBJ_NEW('IDLffShape', FILEPATH('cities.shp', $</p>
        <p class="Code_Indented">&#160;&#160;&#160;SUBDIR=['examples', 'data']), /UPDATE, ENTITY_TYPE=1)</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Set the attribute definitions for the new Shapefile</p>
        <p class="Code_Indented">mynewshape-&gt;AddAttribute, 'CITY_NAME', 7, 25, PRECISION=0</p>
        <p class="Code_Indented">mynewshape-&gt;AddAttribute, 'STAT_NAME', 7, 25, PRECISION=0</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Create structure for new entity</p>
        <p class="Code_Indented">entNew = {IDL_SHAPE_ENTITY}</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Define the values for the new entity</p>
        <p class="Code_Indented">entNew.SHAPE_TYPE = 1</p>
        <p class="Code_Indented">entNew.BOUNDS[0] = -104.87270</p>
        <p class="Code_Indented">entNew.BOUNDS[1] = 39.768040</p>
        <p class="Code_Indented">entNew.BOUNDS[2] = 0.00000000</p>
        <p class="Code_Indented">entNew.BOUNDS[3] = 0.00000000</p>
        <p class="Code_Indented">entNew.BOUNDS[4] = -104.87270</p>
        <p class="Code_Indented">entNew.BOUNDS[5] = 39.768040</p>
        <p class="Code_Indented">entNew.BOUNDS[6] = 0.00000000</p>
        <p class="Code_Indented">entNew.BOUNDS[7] = 0.00000000</p>
        <p class="Code_Indented">entNew.N_VERTICES = 1 ; take out of example, need as workaround</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Create structure for new attributes</p>
        <p class="Code_Indented">attrNew = mynewshape-&gt;GetAttributes(/ATTRIBUTE_STRUCTURE)</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Define the values for the new attributes</p>
        <p class="Code_Indented">attrNew.ATTRIBUTE_0 = 'Denver'</p>
        <p class="Code_Indented">attrNew.ATTRIBUTE_1 = 'Colorado'</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Add the new entity to new shapefile</p>
        <p class="Code_Indented">mynewshape-&gt;PutEntity, entNew</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Note that because this is a new shapefile, the index of</p>
        <p class="Code_Indented">; the new entity is zero.</p>
        <p class="Code_Indented">entity_index = 0</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Add the Colorado attributes to new shapefile.</p>
        <p class="Code_Indented">mynewshape-&gt;SetAttributes, entity_index, attrNew</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Close the shapefile</p>
        <p class="Code_Indented">OBJ_DESTROY, mynewshape</p>
        <p class="Code">&#160;</p>
        <p class="Code">END</p>
        <h2 class="API"><a name="objects_ff_3755668711_1360452"></a>Updating Existing Shapefiles</h2>
        <p>You can modify existing Shapefiles with the following:</p>
        <ul>
            <li value="1">Adding new entities</li>
            <li value="2">Adding new attributes (only to Shapefiles without any existing values in any attributes)</li>
            <li value="3">Modifying existing attributes</li>
        </ul>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>You cannot modify existing entities.</p>
        <p>For example, the following program adds an entity and attributes for the city of Boulder to the <code>cities.shp</code> file created in the previous example:</p>
        <p class="Code">PRO ex_shapefile_modify</p>
        <p class="Code">&#160;</p>
        <p class="Code_Indented">; Open the cities Shapefile</p>
        <p class="Code_Indented">myshape = OBJ_NEW('IDLffShape', FILEPATH('cities.shp', $</p>
        <p class="Code_Indented">&#160;&#160;&#160;SUBDIR=['examples', 'data']), /UPDATE)</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Create structure for new entity</p>
        <p class="Code_Indented">entNew = {IDL_SHAPE_ENTITY}</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Define the values for the new entity</p>
        <p class="Code_Indented">entNew.SHAPE_TYPE = 1</p>
        <p class="Code_Indented">entNew.ISHAPE = 200</p>
        <p class="Code_Indented">entNew.BOUNDS[0] = -105.25100</p>
        <p class="Code_Indented">entNew.BOUNDS[1] = 40.026878</p>
        <p class="Code_Indented">entNew.BOUNDS[2] = 0.00000000</p>
        <p class="Code_Indented">entNew.BOUNDS[3] = 0.00000000</p>
        <p class="Code_Indented">entNew.BOUNDS[4] = -105.25100</p>
        <p class="Code_Indented">entNew.BOUNDS[5] = 40.026878</p>
        <p class="Code_Indented">entNew.BOUNDS[6] = 0.00000000</p>
        <p class="Code_Indented">entNew.BOUNDS[7] = 0.00000000</p>
        <p class="Code_Indented">entNew.N_VERTICES = 1 ; take out of example, need as workaround</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Create structure for new attributes</p>
        <p class="Code_Indented">attrNew = myshape-&gt;GetAttributes(/ATTRIBUTE_STRUCTURE)</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Define the values for the new attributes</p>
        <p class="Code_Indented">attrNew.ATTRIBUTE_0 = 'Boulder'</p>
        <p class="Code_Indented">attrNew.ATTRIBUTE_1 = 'Colorado'</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Add the new entity to new shapefile</p>
        <p class="Code_Indented">myshape-&gt;PutEntity, entNew</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Determine the zero-based index of the new entity</p>
        <p class="Code_Indented">myshape-&gt;GetProperty, N_ENTITIES=num_entities</p>
        <p class="Code_Indented">entity_index = num_entities-1</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Add the Colorado attributes to new shapefile</p>
        <p class="Code_Indented">myshape-&gt;SetAttributes, entity_index, attrNew</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Close the shapefile</p>
        <p class="Code_Indented">OBJ_DESTROY, myshape</p>
        <p class="Code">&#160;</p>
        <p class="Code">END</p>
        <h2 class="API">Graphing an Updated Shapefile</h2>
        <p>The following program graphs the <code>cities.shp</code> file that was created and updated in the previous examples:</p>
        <p class="Code">PRO plot_cities</p>
        <p class="Code">&#160;</p>
        <p class="Code_Indented">DEVICE, RETAIN=2, DECOMPOSED=0</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">!P.BACKGROUND = 255</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">;Define a color table</p>
        <p class="Code_Indented">r=BYTARR(256) &amp; g = BYTARR(256) &amp; b = BYTARR(256)</p>
        <p class="Code_Indented">r[0] = 0 &amp; g[0] = 0 &amp; b[0]=0 ;Definition of black</p>
        <p class="Code_Indented">r[1] = 100 &amp; g[1] = 100 &amp; b[1] = 255 ;Definition of blue</p>
        <p class="Code_Indented">r[2] = 0 &amp; g[2] = 255 &amp; b[2] = 0 ;Definition of green</p>
        <p class="Code_Indented">r[3] = 255 &amp; g[3] = 255 &amp; b[3] = 0 ;Definition of yellow</p>
        <p class="Code_Indented">r[255] = 255 &amp; g[255] = 255 &amp; b[255] = 255 ;Definition of white</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">TVLCT, r, g, b</p>
        <p class="Code_Indented">black = 0 &amp; blue = 1 &amp; green = 2 &amp; yellow = 3 &amp; white = 255</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Set up map to plot Shapefile on</p>
        <p class="Code_Indented">MAP_SET, /ORTHO, 39, -104, SCALE=9e6, /ISOTROPIC, $</p>
        <p class="Code_Indented">/HORIZON, E_HORIZON={FILL:1, COLOR:green}, COLOR=yellow</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Show state borders:</p>
        <p class="Code_Indented">MAP_CONTINENTS, /USA, COLOR=black</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Open the states Shapefile in the examples directory</p>
        <p class="Code_Indented">myshape = OBJ_NEW('IDLffShape', FILEPATH('states.shp', $</p>
        <p class="Code_Indented">&#160;&#160;&#160;SUBDIR=['examples', 'data']))</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Get the number of entities so we can parse through them</p>
        <p class="Code_Indented">myshape-&gt;GetProperty, N_ENTITIES=num_ent</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Parsing through the entities and only plotting the state of</p>
        <p class="Code_Indented">; Colorado</p>
        <p class="Code_Indented">FOR x=1, (num_ent-1) DO BEGIN</p>
        <p class="Code_Indented">&#160;&#160;&#160;; Get the Attributes for entity x</p>
        <p class="Code_Indented">&#160;&#160;&#160;attr = myshape-&gt;GetAttributes(x)</p>
        <p class="Code_Indented">&#160;&#160;&#160;; See if 'Colorado' is in ATTRIBUTE_1 of the attributes for</p>
        <p class="Code_Indented">&#160;&#160;&#160;; entity x</p>
        <p class="Code_Indented">&#160;&#160;&#160;IF attr.ATTRIBUTE_1 EQ 'Colorado' THEN BEGIN</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;; Get entity</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;ent = myshape-&gt;GetEntity(x)</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;; Plot entity</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;POLYFILL, (*ent.VERTICES)[0, *], (*ent.VERTICES)[1, *], $</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;COLOR=yellow</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;; Clean-up of pointers</p>
        <p class="Code_Indented">&#160;&#160;&#160;&#160;&#160;&#160;myshape-&gt;DestroyEntity, ent</p>
        <p class="Code_Indented">&#160;&#160;&#160;ENDIF</p>
        <p class="Code_Indented">ENDFOR</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Close the states Shapefile</p>
        <p class="Code_Indented">OBJ_DESTROY, myshape</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Open the cities Shapefile</p>
        <p class="Code_Indented">myshape = OBJ_NEW('IDLffShape', FILEPATH('cities.shp', $</p>
        <p class="Code_Indented">&#160;&#160;&#160;SUBDIR=['examples', 'data']))</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Get the number of entities so we can parse through them</p>
        <p class="Code_Indented">myshape-&gt;GetProperty, N_ENTITIES=num_ent</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Plot the cities on the map of Colorado</p>
        <p class="Code_Indented">FOR x=0, (num_ent-1) DO BEGIN</p>
        <p class="Code_Indented">; Get entity</p>
        <p class="Code_Indented">ent = myshape-&gt;GetEntity(x)</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Get city attribute</p>
        <p class="Code_Indented">attr = myshape-&gt;GetAttributes(x)</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Plot the cities with a symbol, as well as the city name</p>
        <p class="Code_Indented">PLOTS, ent.BOUNDS[0], ent.BOUNDS[1], PSYM=5, COLOR=black</p>
        <p class="Code_Indented">XYOUTS, ent.BOUNDS[0] + 0.3, ent.BOUNDS[1], $</p>
        <p class="Code_Indented">&#160;&#160;&#160;attr.ATTRIBUTE_0, color=black</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Clean-up of pointers</p>
        <p class="Code_Indented">myshape-&gt;DestroyEntity, ent</p>
        <p class="Code_Indented">ENDFOR</p>
        <p class="Code_Indented">&#160;</p>
        <p class="Code_Indented">; Close the Shapefile</p>
        <p class="Code_Indented">OBJ_DESTROY, myshape</p>
        <p class="Code">&#160;</p>
        <p class="Code">END</p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>