<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: S">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>SIMPLEX </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="S_list.htm">Routines: S</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">SIMPLEX</span>
        </div>
        <h1 class="Routine"><a name="S_820040301_1103717"></a><a name="kanchor2383"></a><a name="S_820040301_96227"></a>SIMPLEX </h1>
        <p><a name="kanchor2384"></a>The SIMPLEX function uses the simplex method to solve linear programming problems. Given a set of <i>N</i> independent variables <i>X</i><sub class="italic">i</sub>, where <i>i</i> = <i>0, ..., N</i>, the simplex method seeks to maximize the following function,</p>
        <p>
            <img src="../../images/25_2.jpg" />
        </p>
        <p>with the assumption that X<sub class="italic">i</sub>≥ 0. The <i>X</i><sub class="italic">i</sub> are further constrained by the following equations:</p>
        <p>
            <img src="../../images/25_3.jpg" />
        </p>
        <p>
            <img src="../../images/25_4.jpg" />
        </p>
        <p>
            <img src="../../images/25_5.jpg" />
        </p>
        <p>where M = M<sub>1</sub> + M<sub>2</sub> + M<sub>3</sub> is the total number of equations, and the constraint values <i>c</i><sub class="italic">j </sub>must all be positive.</p>
        <p>To solve the above problem using the SIMPLEX function, the <i>Z</i> equation is rewritten as a vector:</p>
        <p>
            <img src="../../images/25_6.jpg" />
        </p>
        <p>The constraint equations are rewritten as a matrix with <i>N</i>+1 columns and <i>M</i> rows, where all of the <i>b</i> coefficients have had their sign reversed:</p>
        <p>
            <img src="../../images/25_7.jpg" />
        </p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>The constraint matrix must be organized so that the coefficients for the less-than (&lt;) equations come first, followed by the coefficients of the greater-than (&gt;) equations, and then the coefficients of the equal (=) equations.</p>
        <p>The SIMPLEX function is based on the routine <code>simplx</code> described in section 10.8 of <i>Numerical Recipes in C: The Art of Scientific Computing</i> (Second Edition), published by Cambridge University Press, and is used by permission.</p>
        <h2 class="API"><a name="S_820040301_1103759"></a><a name="S_820040301_1103759_PageTOC_SIMPLEX_"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = SIMPLEX( <i>Zequation</i>, <i>Constraints</i>, <i>M</i><sub class="italic">1</sub>, <i>M</i><sub class="italic">2</sub>, <i>M</i><sub class="italic">3</sub> [,&#160;<i>Tableau</i>&#160;[,&#160;<i>Izrov</i>&#160;[,&#160;<i>Iposv</i>]&#160;]&#160;] [,&#160;/<a href="#S_820040301_1103779" class="selected">DOUBLE</a>] [,&#160;<a href="#S_820040301_1103781" class="selected">EPS</a>&#160;=&#160;<i>value</i>] [,&#160;<a href="#S_820040301_1103783" class="selected">STATUS</a>&#160;=&#160;<i>variable</i>]&#160;)</p>
        <h2 class="API"><a name="S_820040301_1133477"></a><a name="S_820040301_82160"></a>Return Value</h2>
        <p>The <i>Result</i> is a vector of <i>N</i>+1 elements containing the maximum <i>Z</i> value and the values of the <i>N</i> independent <i>X </i>variables (the optimal feasible vector)<a name="kanchor2385"></a>:</p>
        <p>
            <img src="../../images/25_1.jpg" />
        </p>
        <h2 class="API"><a name="S_820040301_1103761"></a><a name="S_820040301_1103761_PageTOC_SIMPLEX_"></a>Arguments</h2>
        <h3 class="Argument">Zequation</h3>
        <p>A vector containing the <i>N</i> coefficients of the <i>Z</i><sub>equation</sub> to be maximized.</p>
        <h3 class="Argument">Constraints</h3>
        <p>An array of <i>N</i>+1 columns by <i>M</i> rows containing the constraint values and coefficients for the constraint equations.</p>
        <h3 class="Argument">M1</h3>
        <p>An integer giving the number of less-than constraint equations contained in <i>Constraints</i>. <i>M1</i> may be zero, indicating that there are no less than constraints.</p>
        <h3 class="Argument">M2</h3>
        <p>An integer giving the number of greater-than constraint equations contained in <i>Constraints</i>. <i>M2</i> may be zero, indicating that there are no greater than constraints.</p>
        <h3 class="Argument">M3</h3>
        <p>An integer giving the number of equal-to constraint equations contained in <i>Constraints</i>. <i>M3</i> may be zero, indicating that there are no equal to constraints. The total of <i>M1</i> + <i>M2</i> + <i>M3</i> should equal M, the number of constraint equations.</p>
        <h3 class="Argument">Tableau</h3>
        <p>Set this optional argument to a named variable in which to return the output array from the simplex algorithm. For more detailed discussion about this argument, see the write-up in section 10.8 of <i>Numerical Recipes in C</i>.</p>
        <h3 class="Argument">Izrov</h3>
        <p>Set this optional argument to a named variable in which to return the output izrov variable from the simplex algorithm. For more detailed discussion about this argument, see the write-up in section 10.8 of <i>Numerical Recipes in C</i>.</p>
        <h3 class="Argument">Iposv</h3>
        <p>Set this optional argument to a named variable in which to return the output iposv variable from the simplex algorithm. For more detailed discussion about this argument, see the write-up in section 10.8 of <i>Numerical Recipes in C</i>.</p>
        <h2 class="API"><a name="S_820040301_1103778"></a><a name="S_820040301_1103778_PageTOC_SIMPLEX_"></a>Keywords</h2>
        <h3 class="Keyword"><a name="S_820040301_1103779"></a><a name="S_820040301_1103779_Keywords_SIMPLEX__"></a>DOUBLE</h3>
        <p>Set this keyword to use double-precision for computations and to return a double-precision result. Set DOUBLE to 0 to use single-precision for computations and to return a single-precision result. The default is /DOUBLE if any of the inputs are double-precision, otherwise the default is 0.</p>
        <h3 class="Keyword"><a name="S_820040301_1103781"></a><a name="S_820040301_1103781_Keywords_SIMPLEX__"></a>EPS</h3>
        <p>Set this keyword to a number close to machine accuracy, which is used to test for convergence at each iteration. The default is 10<sup>–6</sup>.</p>
        <h3 class="Keyword"><a name="S_820040301_1103783"></a><a name="S_820040301_1103783_Keywords_SIMPLEX__"></a>STATUS</h3>
        <p>Set this keyword to a named variable to receive the status of the operation. Possible status values are:</p>
        <table style="caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Description.css');" cellspacing="0" class="TableStyle_Description">
            <col />
            <col />
            <thead>
                <tr>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Value</p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                        <p>Description</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>Successful completion.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>The objective function is unbounded.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>2</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>No solution satisfies the given constraints.</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
                        <p>3</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowEnd_ColEnd">
                        <p>The routine did not converge.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="S_820040301_1103810"></a><a name="S_820040301_1103810_PageTOC_SIMPLEX_"></a>Examples</h2>
        <p>The following example is taken from <i>Numerical Recipes in C</i>.</p>
        <p>Find the Z value which maximizes the equation <i>Z</i> = <i>X</i><sub class="italic">1</sub> + <i>X</i><sub class="italic">2</sub> + 3 <i>X</i><sub class="italic">3</sub> - 0.5 <i>X</i><sub class="italic">4</sub>, with the following constraints:</p>
        <p>
            <img src="../../images/25_8.jpg" />
        </p>
        <p>
            <img src="../../images/25_9.jpg" />
        </p>
        <p>
            <img src="../../images/25_10.jpg" />
        </p>
        <p>
            <img src="../../images/25_11.jpg" />
        </p>
        <p>To find the solution, enter the following code at the IDL command line:</p>
        <p class="Code">; Set up the Zequation with the X coefficients.<br />Zequation = [1,1,3,-0.5]<br />; Set up the Constraints matrix.<br />Constraints = [ $<br />&#160;&#160;&#160;[740, -1,  0, -2,  0], $<br />&#160;&#160;&#160;[  0,  0, -2,  0,  7], $<br />&#160;&#160;&#160;[0.5,  0, -1,  1, -2], $<br />&#160;&#160;&#160;[  9, -1, -1, -1, -1] ]<br />; Number of less-than constraint equations.<br />m1 = 2 <br />; Number of greater-than constraint equations.<br />m2 = 1 <br />; Number of equal constraint equations.<br />m3 = 1 <br />; <br />; Call the function.<br />result = SIMPLEX(Zequation, Constraints, m1, m2, m3)<br />;<br />; Print out the results.<br />PRINT, 'Maximum Z value is: ', result[0]<br />PRINT, 'X coefficients are: '<br />PRINT, result[1:*]</p>
        <p>IDL prints:</p>
        <p class="Code">Maximum Z value is:       17.0250</p>
        <p class="Code">X coefficients are:</p>
        <p class="Code">      0.000000      3.32500      4.72500     0.950000</p>
        <p>Therefore, the optimal feasible vector is <i>X</i><sub class="italic">1</sub> = 0.0, <i>X</i><sub class="italic">2</sub> = 3.325, <i>X</i><sub class="italic">3</sub> = 4.725, and <i>X</i><sub class="italic">4</sub>&#160;=&#160;0.95.</p>
        <h2 class="API"><a name="S_820040301_1103857"></a><a name="S_820040301_1103857_PageTOC_SIMPLEX_"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>5.5</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="S_820040301_1110309"></a><a name="S_820040301_1110309_PageTOC_SIMPLEX_"></a>See Also</h2>
        <p><a href="../A/AMOEBA.htm#A_850317933_992475">AMOEBA</a>, <a href="../D/DFPMIN.htm#D_843829869_861630">DFPMIN</a>, <a href="../P/POWELL.htm#P_817877613_51436">POWELL</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>