<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: Q">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>QSIMP </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Q_list.htm">Routines: Q</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">QSIMP</span>
        </div>
        <h1 class="Routine"><a name="Q_815714925_51645"></a><a name="kanchor2131"></a><a name="Q_815714925_21978"></a>QSIMP </h1>
        <p><a name="kanchor2132"></a>The QSIMP function performs numerical integration of a function over the closed interval [<i>A, B</i>] using Simpson’s rule. <a name="kanchor2133"></a><a name="kanchor2134"></a></p>
        <h2 class="API"><a name="Q_815714925_51679"></a><a name="Q_815714925_51679_PageTOC_QSIMP_"></a>Examples</h2>
        <p>To integrate the SIMPSON function (listed above) over the interval [0, π/2] and print the result:</p>
        <p class="Code">; Define lower limit of integration:<br />A = 0.0<br /><br />; Define upper limit of integration:<br />B = !PI/2.0<br /><br />PRINT, QSIMP('simpson', A, B)</p>
        <p>IDL prints:</p>
        <p class="Code">&#160;-0.479158</p>
        <p>The exact solution can be found using the integration-by-parts formula:</p>
        <p class="Code">FB = 4.*B*(B^2-7.)*SIN(B) - (B^4-14.*B^2+28.)*COS(B)<br />FA = 4.*A*(A^2-7.)*SIN(A) - (A^4-14.*A^2+28.)*COS(A)<br />exact = FB - FA<br />PRINT, exact</p>
        <p>IDL prints:</p>
        <p class="Code">&#160;-0.479156</p>
        <h2 class="API"><a name="Q_815714925_51653"></a><a name="Q_815714925_51653_PageTOC_QSIMP_"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = QSIMP( <i>Func</i>, <i>A</i>, <i>B</i> [,&#160;/<a href="#Q_815714925_51671" class="selected">DOUBLE</a>] [,&#160;<a href="#Q_815714925_51674" class="selected">EPS</a>=<i>value</i>] [,&#160;<a href="#Q_815714925_51677" class="selected">JMAX</a>=<i>value</i>] )</p>
        <h2 class="API"><a name="Q_815714925_1079052"></a><a name="Q_815714925_65580"></a>Return Value</h2>
        <p>The result will have the same structure as the smaller of <i>A</i> and <i>B</i>, and the resulting type will be single- or double-precision floating, depending on the input types.</p>
        <h2 class="API"><a name="Q_815714925_51655"></a><a name="Q_815714925_51655_PageTOC_QSIMP_"></a>Arguments </h2>
        <h3>Func</h3>
        <p>A scalar string specifying the name of a user-supplied IDL function to be integrated. This function must accept a single scalar argument <i>X</i> and return a scalar result. It must be defined over the closed interval [<i>A, B</i>]. </p>
        <p>For example, if we wish to integrate the fourth-order polynomial</p>
        <p class="indent">y = (x<sup>4</sup> - 2x<sup>2</sup>) sin(x)</p>
        <p>we define a function SIMPSON to express this relationship in the IDL language:</p>
        <p class="Code">FUNCTION simpson, X</p>
        <p class="Code">&#160;&#160;&#160;RETURN, (X^4 - 2.0 * X^2) * SIN(X)</p>
        <p class="Code">END</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If  QSIMP is complex then only the real part is used for the computation.</p>
        <h3>A</h3>
        <p>The lower limit of the integration. <i>A</i> can be either a scalar or an array. </p>
        <h3>B</h3>
        <p>The upper limit of the integration. <i>B</i> can be either a scalar or an array.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If arrays are specified for <i>A</i> and <i>B</i>, then QSIMP integrates the user-supplied function over the interval [<i>A</i><sub class="italic">i</sub>, <i>B</i><sub class="italic">i</sub>] for each <i>i</i>. If either <i>A</i> or <i>B</i> is a scalar and the other an array, the scalar is paired with each array element in turn.</p>
        <h2 class="API"><a name="Q_815714925_51669"></a><a name="Q_815714925_51669_PageTOC_QSIMP_"></a>Keywords</h2>
        <h3 class="Keyword"><a name="Q_815714925_51671"></a><a name="Q_815714925_51671_Keywords_QSIMP__"></a>DOUBLE</h3>
        <p>Set this keyword to force the computation to be done in double-precision arithmetic.</p>
        <h3 class="Keyword"><a name="Q_815714925_51674"></a><a name="Q_815714925_51674_Keywords_QSIMP__"></a>EPS</h3>
        <p>The desired fractional accuracy. For single-precision calculations, the default value is 1.0 x 10<sup>-6</sup>. For double-precision calculations, the default value is 1.0 x 10<sup>-12</sup>.</p>
        <h3 class="Keyword"><a name="Q_815714925_51677"></a><a name="Q_815714925_51677_Keywords_QSIMP__"></a>JMAX</h3>
        <p>2<sup>(JMAX - 1)</sup> is the maximum allowed number of steps. If not specified, a default of 20 is used.</p>
        <h2 class="API"><a name="Q_815714925_51693"></a><a name="Q_815714925_51693_PageTOC_QSIMP_"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>4.0</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API">Resources and References</h2>
        <p>QSIMP is based on the routine <code>qsimp</code> described in section 4.2 of <i>Numerical Recipes in C: The Art of Scientific Computing</i> (Second Edition), published by Cambridge University Press, and is used by permission.</p>
        <h2 class="API"><a name="Q_815714925_1076461"></a><a name="Q_815714925_1076461_PageTOC_QSIMP_"></a>See Also</h2>
        <p><a href="../I/INT_2D.htm#I_833016429_883951">INT_2D</a>, <a href="../I/INT_3D.htm#I_833016429_750234">INT_3D</a>, <a href="../I/INT_TABULATED.htm#I_833016429_750296">INT_TABULATED</a>, <a href="QROMB.htm#Q_815714925_51508">QROMB</a>, <a href="QROMO.htm#Q_815714925_51569">QROMO</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>