<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: N">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>NEWTON </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="N_list.htm">Routines: N</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">NEWTON</span>
        </div>
        <h1 class="Routine"><a name="N_830853741_927550"></a><a name="kanchor1949"></a><a name="N_830853741_50918"></a>NEWTON </h1>
        <p><a name="kanchor1950"></a><a name="kanchor1951"></a>The NEWTON function solves a system of <i>n</i> non-linear equations in <i>n</i> dimensions using a globally-convergent Newton’s method. </p>
        <p>NEWTON is based on the routine <code>newt</code> described in section 9.7 of <i>Numerical Recipes in C: The Art of Scientific Computing</i> (Second Edition), published by Cambridge University Press, and is used by permission.</p>
        <h2 class="API"><a name="N_830853741_889339"></a><a name="N_830853741_889339_PageTOC_NEWTON_"></a>Examples</h2>
        <p>Use NEWTON to solve an <i>n</i>-dimensional system of <i>n</i> non-linear equations. Systems of non-linear equations may have multiple solutions; starting the algorithms with different initial guesses enables detection of different solutions.</p>
        <p class="Code">FUNCTION newtfunc, X<br />RETURN, [X[0] + X[1] - 3, X[0]^2 + X[1]^2 - 9]<br /><br />END<br /><br />PRO TEST_NEWTON<br /><br />; Provide an initial guess as the algorithm's starting point:<br />X = [1d, 5d]<br /><br />; Compute the solution:<br />result = NEWTON(X, 'newtfunc')<br /><br />; Print the result:<br />PRINT, 'For X=[1.0, 5.0], result = ', result<br /><br />;Try a different starting point.<br />X = [1d, -1d]<br /><br />; Compute the solution:<br />result = NEWTON(X,'newtfunc')<br /><br />;Print the result.<br />PRINT, 'For X=[1.0, -1.0], result = ', result<br /><br />END<br /><br />TEST_NEWTON</p>
        <p>IDL prints:</p>
        <p class="Code">For X=[1.0, 5.0], result =  -2.4871776e-006       3.0000025</p>
        <p class="Code">For X=[1.0, -1.0], result =        3.0000000 -2.9985351e-008</p>
        <h2 class="API"><a name="N_830853741_889303"></a><a name="N_830853741_889303_PageTOC_NEWTON_"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = NEWTON( <i>X</i>, <i>Vecfunc</i> [,&#160;<a href="#N_830853741_889318" class="selected">CHECK</a>=<i>variable</i>] [,&#160;/<a href="#N_830853741_889321" class="selected">DOUBLE</a>] [,&#160;<a href="#N_830853741_928608" class="selected">ITMAX</a>=<i>value</i>] [,&#160;<a href="#N_830853741_889327" class="selected">STEPMAX</a>=<i>value</i>] [,&#160;<a href="#N_830853741_889330" class="selected">TOLF</a>=<i>value</i>] [,&#160;<a href="#N_830853741_889334" class="selected">TOLMIN</a>=<i>value</i>] [,&#160;<a href="#N_830853741_889337" class="selected">TOLX</a>=<i>value</i>] )</p>
        <h2 class="API"><a name="N_830853741_931001"></a><a name="N_830853741_98501"></a>Return Value</h2>
        <p>The result is an <i>n</i>-element vector containing the solution.</p>
        <h2 class="API"><a name="N_830853741_889305"></a><a name="N_830853741_889305_PageTOC_NEWTON_"></a>Arguments</h2>
        <h3 class="Argument">X</h3>
        <p>An <i>n</i>-element vector containing an initial guess at the solution of the system.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If  NEWTON is complex then only the real part is used for the computation.</p>
        <h3 class="Argument">Vecfunc</h3>
        <p>A scalar string specifying the name of a user-supplied IDL function that defines the system of non-linear equations. This function must accept an <i>n</i>-element vector argument <i>X</i> and return an <i>n</i>-element vector result.</p>
        <p>For example, suppose the non-linear system is defined by the following equations:</p>
        <p class="indent"><i>y</i><sub>0</sub> = <i>x</i><sub>0</sub> + <i>x</i><sub>1</sub> - 3,&#160;&#160;&#160;&#160;&#160;<i>y</i><sub>1</sub> = <i>x</i><sub>0</sub><sup>2</sup> + <i>x</i><sub>1</sub><sup>2</sup> - 9</p>
        <p>We write a function NEWTFUNC to express these relationships in the IDL language:</p>
        <p class="Code">FUNCTION newtfunc, X</p>
        <p class="Code">&#160;&#160;&#160;RETURN, [X[0] + X[1] -3.0, X[0]^2 + X[1]^2 - 9.0]</p>
        <p class="Code">END</p>
        <h2 class="API"><a name="N_830853741_928017"></a><a name="N_830853741_928017_PageTOC_NEWTON_"></a>Keywords</h2>
        <h3 class="Keyword"><a name="N_830853741_889318"></a><a name="N_830853741_889318_Keywords_NEWTON__"></a>CHECK</h3>
        <p>NEWTON calls an internal function named <code>fmin()</code> to determine whether the routine has converged to a local minimum rather than to a global minimum (see <i>Numerical Recipes</i>, section 9.7). Use the CHECK keyword to specify a named variable which will be set to 1 if the routine has converged to a local minimum or to 0 if it has not. If the routine does converge to a local minimum, try restarting from a different initial guess to obtain the global minimum.</p>
        <h3 class="Keyword"><a name="N_830853741_889321"></a><a name="N_830853741_889321_Keywords_NEWTON__"></a>DOUBLE</h3>
        <p>Set this keyword to force the computation to be done in double-precision arithmetic.</p>
        <h3 class="Keyword"><a name="N_830853741_928608"></a><a name="N_830853741_928608_Keywords_NEWTON__"></a>ITMAX</h3>
        <p>The maximum allowed number of iterations. The default value is 200. </p>
        <h3 class="Keyword"><a name="N_830853741_889327"></a><a name="N_830853741_889327_Keywords_NEWTON__"></a>STEPMAX</h3>
        <p>The scaled maximum step length allowed in line search. The default value is 100.0.</p>
        <h3 class="Keyword"><a name="N_830853741_889330"></a><a name="N_830853741_889330_Keywords_NEWTON__"></a>TOLF</h3>
        <p>Set the <a name="kanchor1952"></a>convergence criterion on the function values. The default value is 1.0&#160;x&#160;10<sup>-4</sup>.</p>
        <h3 class="Keyword"><a name="N_830853741_889334"></a><a name="N_830853741_889334_Keywords_NEWTON__"></a>TOLMIN</h3>
        <p>Set the criterion for deciding whether spurious convergence to a minimum of the function <code>fmin()</code> has occurred. The default value is 1.0&#160;x&#160;10<sup>-6</sup>.</p>
        <h3 class="Keyword"><a name="N_830853741_889337"></a><a name="N_830853741_889337_Keywords_NEWTON__"></a>TOLX</h3>
        <p>Set the convergence criterion on <i>X</i>. The default value is 1.0&#160;x&#160;10<sup>-7</sup>.</p>
        <h2 class="API"><a name="N_830853741_931945"></a><a name="N_830853741_889351_PageTOC_NEWTON_"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>4.0</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="N_830853741_930172"></a><a name="N_830853741_930172_PageTOC_NEWTON_"></a>See Also</h2>
        <p><a href="../B/BROYDEN.htm#B_856805997_50255">BROYDEN</a>, <a href="../F/FX_ROOT.htm#F_848155245_749869">FX_ROOT</a>, <a href="../F/FZ_ROOTS.htm#F_848155245_52509">FZ_ROOTS</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>