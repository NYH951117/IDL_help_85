<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>IMSL_LINLSQ</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <h1><a name="IMSL_LINLSQ"></a>IMSL_LINLSQ</h1>
        <p>The IMSL_LINLSQ function solves a linear least-squares problem with linear constraints.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>This routine requires an IDL Analyst license. For more information, contact your <span class="DocumentTitleCompanyName">Exelis VIS</span> sales or technical support representative.</p>
        <p>The IMSL_LINLSQ function solves linear least-squares problems with linear constraints. These are systems of least-squares equations of the form</p>
        <p>Ax ≅ b</p>
        <p>subject to</p>
        <p>b<sub>l</sub> ≤ Cx ≤ b<sub>u</sub></p>
        <p>x<sub>l</sub> ≤ x ≤ x<sub>u</sub></p>
        <p>Here <i>A</i> is the coefficient matrix of the least-squares equations, <i>b</i> is the right-hand side, and <i>C</i> is the coefficient matrix of the constraints. The vectors <i>b</i><sub style="font-style: italic;">l</sub><i>, b</i><sub style="font-style: italic;">u</sub><i>, x</i><sub style="font-style: italic;">l</sub> and <i>x</i><sub style="font-style: italic;">u</sub> are the lower and upper bounds on the constraints and the variables, respectively. The system is solved by defining dependent variables <i>y ≡ Cx</i> and then solving the leastsquares system with the lower and upper bounds on <i>x</i> and <i>y</i>. The equation <i>Cx − y = 0</i> is a set of equality constraints. These constraints are realized by heavy weighting, i.e., a penalty method, Hanson (1986, pp. 826-834).</p>
        <h2 class="API">Examples</h2>
        <p>For additional information on using IMSL_LINLSQ, see <a href="#Addition" class="selected"><a href="#Addition" class="selected">Additional Examples</a></a>.</p>
        <h3>Example 1</h3>
        <p>This example solves the following problem in the least-squares sense:</p>
        <p>
            <img src="images/IMSL_LINLSQ_ex1.png" />
        </p>
        <p class="Code">a = TRANSPOSE([[3.0, 2.0, 1.0], [4.0, 2.0, 1.0], $</p>
        <p class="Code">[2.0, 2.0, 1.0], [1.0, 1.0, 1.0]])</p>
        <p class="Code">b = [3.3, 2.3, 1.3, 1.0]</p>
        <p class="Code">c = [[1.0], [1.0], [1.0]]</p>
        <p class="Code">xub = [0.5, 0.5, 0.5]</p>
        <p class="Code">xlb = [0.0, 0.0, 0.0]</p>
        <p class="Code">contype = [1]</p>
        <p class="Code">bc = [1.0]</p>
        <p class="Code">; Note that only upper bound is set for contype =1.</p>
        <p class="Code">sol = IMSL_LINLSQ(b, a, c, bc, bc, contype, Xlb = xlb, Xub = xub)</p>
        <p class="Code">PM, sol, Title = 'Solution'</p>
        <p class="Code_Indented">0.500000</p>
        <p class="Code_Indented">0.300000</p>
        <p class="Code_Indented">0.200000</p>
        <h2 class="API">Syntax</h2>
        <p><i>Result</i> = IMSL_LINLSQ( <i>b, a, c, bl, bu, contype</i> [, <a href="#ABS_TOLE" class="selected">ABS_TOLERANCE</a>=<i>value</i>] [, /<a href="#DOUBLE" class="selected">DOUBLE</a>] [, <a href="#ITMAX" class="selected">ITMAX</a>=<i>value</i>] [, <a href="#REL_TOLE" class="selected">REL_TOLERANCE</a>=<i>value</i>] [, <a href="#RESIDUAL" class="selected">RESIDUAL</a>=<i>variable</i>] [, <a href="#XLB" class="selected">XLB</a>=<i>array</i>] [, <a href="#XUB" class="selected">XUB</a>=<i>array</i>])</p>
        <h2 class="API">Return Value</h2>
        <p>One-dimensional array of length <i>nca</i> containing the approximate solution.</p>
        <h2 class="API">Arguments</h2>
        <h3 class="Argument">a</h3>
        <p>Two-dimensional array of size <i>nra</i> by <i>nca</i> containing the coefficients of the leastsquares equations, where <i>nra</i> is the number of least-squares equations and <i>nca</i> is the number of variables.</p>
        <h3 class="Argument">B</h3>
        <p>One-dimensional array of length <i>nra</i> containing the right-hand sides of the least squares equations.</p>
        <h3 class="Argument">C</h3>
        <p>Two-dimensional array of size <i>ncon</i> by <i>nca</i> containing the coefficients of the constraints, where <i>ncon</i> is the number of constraints.</p>
        <h3 class="Argument">BL</h3>
        <p>One-dimensional array of length ncon containing the lower limit of the general constraints. If there is no lower limit on the <i>i</i>-th constraint, then <i>bl(i)</i> will not be referenced.</p>
        <h3 class="Argument">BU</h3>
        <p>One-dimensional array of length ncon containing the upper limit of the general constraints. If there is no upper limit on the <i>i</i>-th constraint, then <i>bu(i)</i> will not be referenced.</p>
        <h3 class="Argument">CONTYPE</h3>
        <p>One-dimensional array of length <i>ncon</i> indicating the type of constraints exclusive of simple bounds, where CONTYPE(<i>i</i>) = 0, 1, 2, 3 indicates =, ≤, ≥, and range constraints, respectively.</p>
        <p>
            <img src="images/IMSL_LINLSQ_table.png" />
        </p>
        <h2 class="API">Keywords</h2>
        <h3 class="Keyword"><a name="ABS_TOLE"></a>ABS_TOLERANCE</h3>
        <p>Absolute rank determination tolerance to be used. Default: ABS_TOLERANCE = SQRT(machine epsilon).</p>
        <h3 class="Keyword"><a name="DOUBLE"></a>DOUBLE</h3>
        <p>If present and nonzero, double precision is used.</p>
        <h3 class="Keyword"><a name="ITMAX"></a>ITMAX</h3>
        <p>Set the maximum number of iterations. Default: ITMAX = 5*max(<i>nra, nca</i>)</p>
        <h3 class="Keyword"><a name="REL_TOLE"></a>REL_TOLERANCE</h3>
        <p>Relative rank determination tolerance to be used. Default: REL_TOLERANCE = SQRT(machine epsilon).</p>
        <h3 class="Keyword"><a name="RESIDUAL"></a>RESIDUAL</h3>
        <p>Named variable into which an one-dimensional array containing the residuals <i>b − Ax</i> of the least-squares equations at the approximate solution is stored.</p>
        <h3 class="Keyword"><a name="XLB"></a>XLB</h3>
        <p>One-dimensional array of length <i>nca</i> containing the lower bound on the variables. If there is no lower bound on the <i>i</i>-th variable, then <i>Xlb(i)</i> should be set to 1.0e30.</p>
        <h3 class="Keyword"><a name="XUB"></a>XUB</h3>
        <p>One-dimensional array of length <i>nca</i> containing the upper bound on the variables. If there is no upper bound on the <i>i</i>-th variable, then <i>XUB(i)</i> should be set to −1.0e30.</p>
        <h2 class="API"><a name="Addition"></a>Additional Examples</h2>
        <h3>Example 2</h3>
        <p>The same problem solved in the first example is solved again. This time residuals of the least-squares equations at the approximate solution are returned, and the norm of the residual vector is printed.</p>
        <p class="Code">a = TRANSPOSE([[3.0, 2.0, 1.0], [4.0, 2.0, 1.0], $</p>
        <p class="Code">[2.0, 2.0, 1.0], [1.0, 1.0, 1.0]])</p>
        <p class="Code">b = [3.3, 2.3, 1.3, 1.0]</p>
        <p class="Code">c = [[1.0], [1.0], [1.0]]</p>
        <p class="Code">xub = [0.5, 0.5, 0.5]</p>
        <p class="Code">xlb = [0.0, 0.0, 0.0]</p>
        <p class="Code">contype = [1]</p>
        <p class="Code">bc = [1.0]</p>
        <p class="Code">sol = IMSL_LINLSQ(b, a, c, bc, bc, contype, Xlb = xlb, $</p>
        <p class="Code">Xub = xub, Residual = residual)</p>
        <p class="Code">PM, sol, Title = 'Solution'</p>
        <p class="Code">Solution</p>
        <p class="Code_Indented">0.500000</p>
        <p class="Code_Indented">0.300000</p>
        <p class="Code_Indented">0.200000</p>
        <p class="Code">PM, residual, Title = 'Residual'</p>
        <p class="Code">Residual</p>
        <p class="Code_Indented">-1.00000</p>
        <p class="Code_Indented">0.500000</p>
        <p class="Code_Indented">0.500000</p>
        <p class="Code_Indented">0.00000</p>
        <p class="Code">PRINT, 'Norm of Residual =', IMSL_NORM(residual)</p>
        <p class="Code">Norm of Residual = 1.22474</p>
        <h2 class="API">Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col style="width: 40px;" />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_ColSep">
                        <p>6.4</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">&#160;</td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">&#160;</td>
                </tr>
            </tbody>
        </table>
        <h2 class="API">See Also</h2>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>