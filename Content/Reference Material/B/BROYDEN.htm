<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: B">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>BROYDEN </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="B_list.htm">Routines: B</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">BROYDEN</span>
        </div>
        <h1 class="Routine"><a name="kanchor124"></a><a name="B_856805997_50255"></a><a name="B_856805997_62043"></a><a name="kanchor125"></a>BROYDEN </h1>
        <p>The BROYDEN function solves a system of <i>n</i>nonlinear equations (where <i>n</i> ≥ 2) in <i>n</i> dimensions using a globally-convergent Broyden’s method. </p>
        <h2 class="API"><a name="B_856805997_50303"></a><a name="B_856805997_50303_PageTOC_BROYDEN_"></a>Examples</h2>
        <p>We can use BROYDEN to solve the non-linear system of equations defined by the BROYFUNC function above:</p>
        <p class="Code">FUNCTION broyfunc, X<br />&#160;&#160;&#160;RETURN, [3.0&#160;*&#160;X[0]&#160;-&#160;COS(X[1]*X[2])&#160;-&#160;0.5,$<br />&#160;&#160;&#160;X[0]^2&#160;-&#160;81.0*(X[1]&#160;+&#160;0.1)^2&#160;+&#160;SIN(X[2])&#160;+&#160;1.06,$<br />&#160;&#160;&#160;EXP(-X[0]*X[1])&#160;+&#160;20.0&#160;*&#160;X[2]&#160;+&#160;(10.0*!PI&#160;-&#160;3.0)/3.0]<br />END<br /><br />;Provide an initial guess as the algorithm's starting point:<br />X = [-1.0, 1.0, 2.0]<br /><br />;Compute the solution:<br />result = BROYDEN(X, 'BROYFUNC')<br /><br />;Print the result:<br />PRINT, result</p>
        <p>IDL prints:</p>
        <p class="Code">&#160;&#160;&#160;0.500000&#160;&#160;-1.10731e-07&#160;&#160;-0.523599</p>
        <p>The exact solution (to eight-decimal accuracy) is [0.5, 0.0, -0.52359877].</p>
        <h2 class="API"><a name="B_856805997_50261"></a><a name="B_856805997_50261_PageTOC_BROYDEN_"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = BROYDEN( <i>X</i>, <i>Vecfunc</i> [,&#160;<a href="#B_856805997_50283" class="selected">CHECK</a>=<i>variable</i>] [,&#160;/<a href="#B_856805997_50286" class="selected">DOUBLE</a>] [,&#160;<a href="#B_856805997_50289" class="selected">EPS</a>=<i>value</i>] [,&#160;<a href="#B_856805997_989330" class="selected">ITMAX</a>=<i>value</i>] [,&#160;<a href="#B_856805997_50292" class="selected">STEPMAX</a>=<i>value</i>] [,&#160;<a href="#B_856805997_50295" class="selected">TOLF</a>=<i>value</i>] [,&#160;<a href="#B_856805997_50298" class="selected">TOLMIN</a>=<i>value</i>] [,&#160;<a href="#B_856805997_50301" class="selected">TOLX</a>=<i>value</i>] )</p>
        <h2 class="API"><a name="B_856805997_996680"></a><a name="B_856805997_96780"></a>Return Value</h2>
        <p>This function returns an <i>n</i>-element vector containing the solution.</p>
        <h2 class="API"><a name="B_856805997_50263"></a><a name="B_856805997_50263_PageTOC_BROYDEN_"></a>Arguments</h2>
        <h3 class="Argument">X</h3>
        <p>An <i>n</i>-element vector (where <i>n</i> ≥ 2) containing an initial guess at the solution of the system.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If BROYDEN is complex then only the real part is used for the computation.</p>
        <h3 class="Argument">Vecfunc</h3>
        <p>A scalar string specifying the name of a user-supplied IDL function that defines the system of non-linear equations. This function must accept a vector argument <i>X</i> and return a vector result.</p>
        <p>For example, suppose we wish to solve the following system:</p>
        <p>
            <img src="../../images/8_8.jpg" />
        </p>
        <p>To represent this system, we define an IDL function named BROYFUNC:</p>
        <p class="Code">FUNCTION broyfunc, X</p>
        <p class="Code">&#160;&#160;&#160;RETURN, [3.0&#160;*&#160;X[0]&#160;-&#160;COS(X[1]*X[2])&#160;-&#160;0.5,$</p>
        <p class="Code">&#160;&#160;&#160;X[0]^2&#160;-&#160;81.0*(X[1]&#160;+&#160;0.1)^2&#160;+&#160;SIN(X[2])&#160;+&#160;1.06,$</p>
        <p class="Code">&#160;&#160;&#160;EXP(-X[0]*X[1])&#160;+&#160;20.0&#160;*&#160;X[2]&#160;+&#160;(10.0*!PI&#160;-&#160;3.0)/3.0]</p>
        <p class="Code">END</p>
        <h2 class="API"><a name="B_856805997_50281"></a><a name="B_856805997_50281_PageTOC_BROYDEN_"></a>Keywords</h2>
        <h3 class="Keyword"><a name="B_856805997_50283"></a><a name="B_856805997_50283_Keywords_BROYDEN__"></a>CHECK</h3>
        <p>BROYDEN calls an internal function named <code>fmin()</code> to determine whether the routine has converged to a local rather than a global minimum (see <i>Numerical Recipes</i>, section 9.7). Use the CHECK keyword to specify a named variable which will be set to 1 if the routine has converged to a local minimum or to 0 if not. If the routine does converge to a local minimum, try restarting from a different initial guess to obtain the global minimum.</p>
        <h3 class="Keyword"><a name="B_856805997_50286"></a><a name="B_856805997_50286_Keywords_BROYDEN__"></a>DOUBLE</h3>
        <p>Set this keyword to force the computation to be done in double-precision arithmetic.</p>
        <h3 class="Keyword"><a name="B_856805997_50289"></a><a name="B_856805997_50289_Keywords_BROYDEN__"></a>EPS</h3>
        <p>Set this keyword to a number close to machine accuracy, used to remove noise from each iteration. The default is 10<sup>-7 </sup>for single precision, and 10<sup>-14 </sup>for double precision.</p>
        <h3 class="Keyword"><a name="B_856805997_989330"></a><a name="B_856805997_989330_Keywords_BROYDEN__"></a>ITMAX</h3>
        <p>Use this keyword to specify the maximum allowed number of iterations. The default is 200. </p>
        <h3 class="Keyword"><a name="B_856805997_50292"></a><a name="B_856805997_50292_Keywords_BROYDEN__"></a>STEPMAX</h3>
        <p>Use this keyword to specify the scaled maximum step length allowed in line searches. The default value is 100.0.</p>
        <h3 class="Keyword"><a name="B_856805997_50295"></a><a name="B_856805997_50295_Keywords_BROYDEN__"></a>TOLF</h3>
        <p>Set the convergence criterion on the function values. The default value is 1.0&#160;x&#160;10<sup>-4</sup>.</p>
        <h3 class="Keyword"><a name="B_856805997_50298"></a><a name="B_856805997_50298_Keywords_BROYDEN__"></a>TOLMIN</h3>
        <p>Set the criterion for deciding whether spurious convergence to a minimum of the function <code>fmin()</code> has occurred. The default value is 1.0&#160;x&#160;10<sup>-6</sup>.</p>
        <h3 class="Keyword"><a name="B_856805997_50301"></a><a name="B_856805997_50301_Keywords_BROYDEN__"></a>TOLX</h3>
        <p>Set the convergence criterion on <i>X</i>. The default value is 1.0&#160;x&#160;10<sup>-7</sup>.</p>
        <h2 class="API"><a name="B_856805997_50311"></a><a name="B_856805997_50311_PageTOC_BROYDEN_"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>Pre 4.0</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API">Resources and References</h2>
        <p>BROYDEN is based on the routine <code>broydn</code> described in section 9.7 of <i>Numerical Recipes in C: The Art of Scientific Computing</i> (Second Edition), published by Cambridge University Press, and is used by permission.</p>
        <h2 class="API"><a name="B_856805997_993468"></a><a name="B_856805997_993468_PageTOC_BROYDEN_"></a>See Also</h2>
        <p><a href="../F/FX_ROOT.htm#F_848155245_749869">FX_ROOT</a>, <a href="../F/FZ_ROOTS.htm#F_848155245_52509">FZ_ROOTS</a>, <a href="../N/NEWTON.htm#N_830853741_927550">NEWTON</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>