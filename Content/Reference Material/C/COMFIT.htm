<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: C">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>COMFIT </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/NoLines.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="C_list.htm">Routines: C</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">COMFIT</span>
        </div>
        <h1 class="Routine"><a name="C_854643309_53189"></a><a name="kanchor293"></a><a name="kanchor294"></a><a name="kanchor295"></a><a name="kanchor296"></a><a name="C_854643309_47619"></a>COMFIT </h1>
        <p>The COMFIT function fits the paired data {<i>xi</i>, <i>yi</i>} to one of six common types of approximating models using a gradient-expansion least-squares method. </p>
        <p>This routine is written in the IDL language. Its source code can be found in the file <code>comfit.pro</code> in the <code>lib</code> subdirectory of the IDL distribution.</p>
        <h2 class="API"><a name="C_854643309_53270"></a><a name="C_854643309_53270_PageTOC_COMFIT_"></a>Examples</h2>
        <p class="Code">; Define two n-element vectors of paired data:<br />X&#160;=&#160;[&#160;2.27, 15.01, 34.74, 36.01, 43.65, 50.02, 53.84, 58.30, $<br />&#160;&#160;&#160;&#160;&#160;62.12, 64.66, 71.66, 79.94, 85.67, 114.95]<br />Y&#160;=&#160;[&#160;5.16, 22.63, 34.36, 34.92, 37.98, 40.22, 41.46, 42.81, $<br />&#160;&#160;&#160;&#160;&#160;43.91, 44.62, 46.44, 48.43, 49.70, 55.31]<br /><br />; Define a 3-element vector of initial estimates for the logsquare<br />; model:<br />A = [1.5, 1.5, 1.5]<br /><br />; Compute the model parameters of the logsquare model, A[0], A[1],<br />; &amp; A[2]:<br />result = COMFIT(X, Y, A, /LOGSQUARE)</p>
        <p>The result should be the 3-element vector: [1.42494, 7.21900, 9.18794].</p>
        <h2 class="API"><a name="C_854643309_53197"></a><a name="C_854643309_53197_PageTOC_COMFIT_"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = COMFIT( <i>X</i>, <i>Y</i>, <i>A</i> [,&#160;/<a href="#C_854643309_1368913" class="selected">DOUBLE</a> | ,&#160;/<a href="#C_854643309_1368785" class="selected">EXPONENTIAL</a> | ,&#160;/<a href="#C_854643309_1368906" class="selected">GEOMETRIC</a> | ,&#160;/<a href="#C_854643309_838937" class="selected">GOMPERTZ</a> | , /<a href="#C_854643309_838944" class="selected">HYPERBOLIC</a> | ,&#160;/<a href="#C_854643309_1368938" class="selected">ITMAX</a> | ,&#160;/<a href="#C_854643309_1368926" class="selected">LOGISTIC</a> | ,&#160;/<a href="#C_854643309_838970" class="selected">LOGSQUARE</a> | ,&#160;<a href="#C_854643309_1368968" class="selected">TOL</a>=<i>value</i>] [,&#160;<a href="#C_854643309_1368795" class="selected">CHISQ</a>=<i>variable</i>] [,&#160;<a href="#C_854643309_1368928" class="selected">ITER</a>=<i>variable</i>] [,&#160;<a href="#C_854643309_838980" class="selected">SIGMA</a>=<i>variable</i>] [,&#160;<a href="#C_854643309_1368948" class="selected">STATUS</a>=<i>variable</i>] [,&#160;<a href="#C_854643309_53265" class="selected">WEIGHTS</a>=<i>vector</i>] [,&#160;<a href="#C_854643309_1368980" class="selected">YERROR</a>=<i>variable</i>] [,&#160;<a href="#C_854643309_1368978" class="selected">YFIT</a>=<i>variable</i>] )</p>
        <h2 class="API"><a name="C_854643309_1104982"></a><a name="C_854643309_33934"></a>Return Value</h2>
        <p>Results in a vector containing the model parameters <i>a</i><sub>0</sub>, <i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>, etc.</p>
        <h2 class="API"><a name="C_854643309_53199"></a><a name="C_854643309_53199_PageTOC_COMFIT_"></a>Arguments</h2>
        <h3 class="Argument">X</h3>
        <p>An n-element vector containing the independent variable values. X may be of type integer, floating point, or double-precision floating-point. </p>
        <h3 class="Argument">Y</h3>
        <p>An <i>n</i>-element integer, single-, or double-precision floating-point vector.</p>
        <h3 class="Argument">A</h3>
        <p><a name="C_854643309_53205"></a>A vector of initial estimates for each model parameter. The length of this vector depends upon the type of model selected.</p>
        <h2 class="API"><a name="C_854643309_53206"></a><a name="C_854643309_53206_PageTOC_COMFIT_"></a>Keywords</h2>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>One of the following keywords specifying a type of model must be set when using COMFIT. If you do not specify a model, IDL will display a warning message when COMFIT is called.</p>
        <h3 class="Keyword"><a name="C_854643309_1368795"></a><a name="C_854643309_26456"></a>CHISQ</h3>
        <p>Set this keyword to a named variable that will contain the value of the reduced chi-square goodness-of-fit statistic.</p>
        <h3 class="Keyword"><a name="C_854643309_1368785"></a><a name="C_854643309_53208_Keywords_COMFIT__"></a>EXPONENTIAL</h3>
        <p>Set this keyword to compute the parameters of the exponential model.</p>
        <p>
            <img src="../../images/9_3.jpg" />
        </p>
        <h3 class="Keyword"><a name="C_854643309_1368913"></a><a name="C_854643309_61952"></a>DOUBLE</h3>
        <p>Set this keyword to force the computation to be done in double-precision arithmetic.</p>
        <h3 class="Keyword"><a name="C_854643309_1368906"></a><a name="C_854643309_838932_Keywords_COMFIT__"></a>GEOMETRIC</h3>
        <p>Set this keyword to compute the parameters of the geometric model.</p>
        <p>
            <img src="../../images/9_4.jpg" />
        </p>
        <h3 class="Keyword"><a name="C_854643309_838937"></a><a name="C_854643309_838937_Keywords_COMFIT__"></a>GOMPERTZ</h3>
        <p>Set this keyword to compute the parameters of the Gompertz model.</p>
        <p>
            <img src="../../images/9_5.jpg" />
        </p>
        <h3 class="Keyword"><a name="C_854643309_838944"></a><a name="C_854643309_838944_Keywords_COMFIT__"></a>HYPERBOLIC</h3>
        <p>Set this keyword to compute the parameters of the hyperbolic model.</p>
        <p>
            <img src="../../images/9_6.jpg" />
        </p>
        <h3 class="Keyword"><a name="C_854643309_1368928"></a><a name="C_854643309_55713"></a>ITER</h3>
        <p>Set this keyword equal to a named variable that will contain the number of iterations performed.</p>
        <h3 class="Keyword"><a name="C_854643309_1368938"></a><a name="C_854643309_89288"></a>ITMAX</h3>
        <p>Set this keyword to specify the maximum number of iterations. The default value is 20.</p>
        <h3 class="Keyword"><a name="C_854643309_1368926"></a><a name="C_854643309_838961_Keywords_COMFIT__"></a>LOGISTIC</h3>
        <p>Set this keyword to compute the parameters of the logistic model.</p>
        <p>
            <img src="../../images/9_7.jpg" />
        </p>
        <h3 class="Keyword"><a name="C_854643309_838970"></a><a name="C_854643309_838970_Keywords_COMFIT__"></a>LOGSQUARE</h3>
        <p>Set this keyword to compute the parameters of the logsquare model.</p>
        <p>
            <img src="../../images/9_8.jpg" />
        </p>
        <h3 class="Keyword"><a name="C_854643309_838980"></a><a name="C_854643309_838980_Keywords_COMFIT__"></a>SIGMA</h3>
        <p>Set this keyword to a named variable that will contain a vector of standard deviations for the computed model parameters.</p>
        <h3 class="Keyword"><a name="C_854643309_1368948"></a><a name="C_854643309_48512"></a>STATUS</h3>
        <p>Set this keyword to a named variable that will contain an integer indicating the status of the computation. Possible return values are:</p>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/NoLines.css');" class="TableStyle_NoLines" cellspacing="0">
            <col class="Column-Column1" />
            <col class="Column-Column1" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="TableStyle_NoLines_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_NoLines_Body_0_0_RowSep_ColEnd">
                        <p>The computation was successful.</p>
                    </td>
                </tr>
                <tr class="Body-Body2">
                    <td class="TableStyle_NoLines_Body_0_0_RowSep_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_NoLines_Body_0_0_RowSep_ColEnd">
                        <p>The computation failed. Chi-square was increasing without bounds.</p>
                    </td>
                </tr>
                <tr class="Body-Body1">
                    <td class="TableStyle_NoLines_Body_0_0_RowEnd_ColSep">
                        <p>2</p>
                    </td>
                    <td class="TableStyle_NoLines_Body_0_0_RowEnd_ColEnd">
                        <p>The computation failed to converge in ITMAX iterations.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3 class="Keyword"><a name="C_854643309_1368968"></a><a name="C_854643309_72710"></a>TOL</h3>
        <p>Set this keyword to specify the desired convergence tolerance. The routine returns when the relative decrease in chi-squared is less than TOL in one iteration. The default value is 1 x 10<sup>-3</sup>. </p>
        <h3 class="Keyword"><a name="C_854643309_53265"></a><a name="C_854643309_53265_Keywords_COMFIT__"></a>WEIGHTS</h3>
        <p>Set this keyword equal to a vector of weights for <i>Y</i><sub>i</sub>. This vector should be the same length as <i>X</i> and <i>Y</i>. The error for each term is weighted by WEIGHTS<sub>i</sub> when computing the fit. Frequently, WEIGHTS<sub>i</sub>&#160;=&#160;1.0/σ<sub>i</sub><sup>2</sup>, where σ is the measurement error or standard deviation of <i>Y</i><sub>i </sub>(Gaussian or instrumental weighting), or WEIGHTS&#160;=&#160;1/Y (Poisson or statistical weighting). If WEIGHTS is not specified, WEIGHTS<sub>i</sub> is assumed to be 1.0.</p>
        <h3 class="Keyword"><a name="C_854643309_1368980"></a><a name="C_854643309_26115"></a>YERROR</h3>
        <p>Set this keyword to a named variable that will contain the standard error between YFIT and Y.</p>
        <h3 class="Keyword"><a name="C_854643309_1368978"></a><a name="C_854643309_53268_Keywords_COMFIT__"></a>YFIT</h3>
        <p>Set this keyword to a named variable that will contain an <i>n</i>-element vector of y-data corresponding to the computed model parameters.</p>
        <h2 class="API"><a name="C_854643309_65784"></a><a name="C_854643309_65784_PageTOC_COMFIT_"></a>Version History</h2>
        <table style="mc-table-style: url('../../Resources/TableStyles/VersionTable.css');margin-left: 0;margin-right: auto;caption-side: top;" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_ColSep">
                        <p>4.0</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>6.4</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Added CHISQ, DOUBLE, ITER, ITMAX, STATUS, TOL, and YERROR keywords.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="C_854643309_1052141"></a><a name="C_854643309_1052141_PageTOC_COMFIT_"></a>See Also</h2>
        <p><a href="CURVEFIT.htm#C_854643309_749660">CURVEFIT</a>, <a href="../L/LADFIT.htm#L_826528365_825372">LADFIT</a>, <a href="../L/LINFIT.htm#L_826528365_53763">LINFIT</a>, <a href="../L/LMFIT.htm#L_826528365_831031">LMFIT</a>, <a href="../P/POLY_FIT.htm#P_817877613_753815">POLY_FIT</a>, <a href="../S/SVDFIT.htm#S_820040301_154010">SVDFIT</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>