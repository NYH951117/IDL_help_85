<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: L">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>LA_SVD </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="L_list.htm">Routines: L</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">LA_SVD</span>
        </div>
        <h1 class="Routine"><a name="L_826528365_960032"></a><a name="kanchor1628"></a><a name="L_826528365_90346"></a>LA_SVD </h1>
        <p><a name="kanchor1629"></a><a name="kanchor1630"></a>The LA_SVD procedure computes the singular value decomposition (SVD) of an <i>n</i>-columns by <i>m</i>-row array as the product of orthogonal and diagonal arrays:</p>
        <p class="indent"><i>A</i> is real: <i>A</i> = <i>U S V</i><sup class="italic">T</sup></p>
        <p class="indent"><i>A</i> is complex: <i>A</i> = <i>U S V</i><sup class="italic">H</sup></p>
        <p>where <i>U</i> is an orthogonal array containing the left singular vectors, <i>S</i> is a diagonal array containing the singular values, and <i>V</i> is an orthogonal array containing the right singular vectors. The superscript <i>T</i> represents the transpose while the superscript <i>H</i> represents the Hermitian, or transpose complex conjugate.</p>
        <p>If <i>n</i> &lt; <i>m</i> then <i>U</i> has dimensions (<i>n&#160;</i>x&#160;<i>m</i>), <i>S </i>has dimensions (<i>n</i>&#160;x&#160;<i>n</i>), and <i>V</i><sup class="italic">H</sup> has dimensions (<i>n</i>&#160;x&#160;<i>n</i>). If <i>n</i>&#160;≥&#160;<i>m</i> then <i>U </i>has dimensions (<i>m</i>&#160;x&#160;<i>m</i>), <i>S</i> has dimensions (<i>m</i>&#160;x&#160;<i>m</i>), and <i>V</i><sup class="italic">H</sup> has dimensions (<i>n</i>&#160;x<i>&#160;m</i>). The following diagram shows the array dimensions:</p>
        <p>&#160;</p>
        <p>
            <img src="../../images/la_svd.png" />
        </p>
        <p>LA_SVD is based on the following LAPACK routines:</p>
        <table style="caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Description.css');" cellspacing="0" class="TableStyle_Description">
            <col />
            <col />
            <col />
            <thead>
                <tr>
                    <td rowspan="2" class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Output Type</p>
                    </td>
                    <td colspan="2" class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                        <p>LAPACK Routine</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>QR Iteration</p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                        <p>Divide-and-conquer</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Float</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>sgesvd</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>sgesdd</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>Double</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>dgesvd</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>dgesdd</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>Complex</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>cgesvd</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>cgesdd</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
                        <p>Double complex</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowEnd_ColSep">
                        <p>zgesvd</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowEnd_ColEnd">
                        <p>zgesdd</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="L_826528365_971158"></a><a name="L_826528365_62300"></a>Examples</h2>
        <p>Construct a sample input array <i>A</i>, consisting of smoothed random values:</p>
        <p class="Code">; Create a smoothed random array:</p>
        <p class="Code">n = 100</p>
        <p class="Code">m = 200</p>
        <p class="Code">seed = 12321</p>
        <p class="Code">a = SMOOTH(RANDOMN(seed, n, m, /DOUBLE, /RAN1), 5)</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Compute the SVD and check reconstruction error:</p>
        <p class="Code">LA_SVD, a, w, u, v</p>
        <p class="Code">arecon = u ## DIAG_MATRIX(w) ## TRANSPOSE(v)</p>
        <p class="Code">PRINT, 'LA_SVD error:', MAX(ABS(arecon - a))</p>
        <p class="Code">&#160;</p>
        <p class="Code">; Keep only the 15 largest singular values</p>
        <p class="Code">wfiltered = w</p>
        <p class="Code">wfiltered[15:*] = 0.0</p>
        <p class="Code">; Reconstruct the array:</p>
        <p class="Code">afiltered = u ## DIAG_MATRIX(wfiltered) ## TRANSPOSE(v)</p>
        <p class="Code">percentVar = 100*(w^2)/TOTAL(w^2)</p>
        <p class="Code">PRINT, 'LA_SVD Variance:', TOTAL(percentVar[0:14])</p>
        <p>IDL prints:</p>
        <p class="Code">LA_SVD error: 1.6209256e-014</p>
        <p class="Code">LA_SVD variance:       82.802816</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>More than 80% of the variance is contained in the 15 largest singular values.</p>
        <h2 class="API"><a name="L_826528365_971136"></a><a name="L_826528365_32570"></a>Syntax</h2>
        <p class="Syntax">LA_SVD, <i>Array</i>, <i>W</i>, <i>U</i>, <i>V</i> [,&#160;/<a href="#L_826528365_971151" class="selected">DOUBLE</a>] [,&#160;/<a href="#L_826528365_971149" class="selected">DIVIDE_CONQUER</a>] [,&#160;<a href="#L_826528365_971153" class="selected">STATUS</a>=<i>variable</i>]</p>
        <h2 class="API"><a name="L_826528365_971138"></a><a name="L_826528365_73387"></a>Arguments</h2>
        <h3 class="Argument">Array</h3>
        <p>The real or complex array to decompose.</p>
        <h3 class="Argument">W</h3>
        <p>On output, <i>W</i> is a vector with MIN(<i>m</i>, <i>n</i>) elements containing the singular values.</p>
        <h3 class="Argument">U</h3>
        <p>On output, <i>U</i> is an orthogonal array with MIN(<i>m</i>, <i>n</i>) columns and <i>m</i> rows used in the decomposition of <i>Array</i>. If <i>Array</i> is complex then <i>U</i> will be complex, otherwise <i>U</i> will be real.</p>
        <h3 class="Argument">V</h3>
        <p>On output, <i>V </i>is an orthogonal array with MIN(<i>m</i>, <i>n</i>) columns and <i>n</i> rows used in the decomposition of <i>Array</i>. If <i>Array</i> is complex then <i>V</i> will be complex, otherwise <i>V</i> will be real.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>To reconstruct <i>Array</i>, you will need to take the transpose or Hermitian of<i> V</i>.</p>
        <h2 class="API"><a name="L_826528365_971148"></a><a name="L_826528365_47561"></a>Keywords</h2>
        <h3 class="Keyword"><a name="L_826528365_971149"></a><a name="L_826528365_971149_Keywords_LA_SVD__"></a>DIVIDE_CONQUER</h3>
        <p>If this keyword is set, then the divide-and-conquer method is used to compute the singular vectors, otherwise, QR iteration is used. The divide-and-conquer method is faster at computing singular vectors of large matrices, but uses more memory and may produce less accurate singular values.</p>
        <h3 class="Keyword"><a name="L_826528365_971151"></a><a name="L_826528365_971151_Keywords_LA_SVD__"></a>DOUBLE</h3>
        <p>Set this keyword to use double-precision for computations and to return a double-precision (real or complex) result. Set DOUBLE = 0 to use single-precision for computations and to return a single-precision (real or complex) result. The default is /DOUBLE if <i>Array</i> is double precision, otherwise the default is DOUBLE = 0.</p>
        <h3 class="Keyword"><a name="L_826528365_971153"></a><a name="L_826528365_971153_Keywords_LA_SVD__"></a>STATUS</h3>
        <p>Set this keyword to a named variable that will contain the status of the computation. Possible values are:</p>
        <ul>
            <li value="1">STATUS = 0: The computation was successful.</li>
            <li value="2">STATUS &gt; 0: The computation did not converge. The STATUS value specifies how many superdiagonals did not converge to zero.</li>
        </ul>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If STATUS is not specified, any error messages will output to the screen.</p>
        <h2 class="API"><a name="L_826528365_971184"></a><a name="L_826528365_29849"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>5.6</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API">Resources and References</h2>
        <p>For details see Anderson et al., <i>LAPACK Users' Guide</i>, 3rd ed., SIAM, 1999.</p>
        <h2 class="API"><a name="L_826528365_971186"></a><a name="L_826528365_25407"></a>See Also</h2>
        <p><a href="LA_CHOLDC.htm#L_826528365_958431">LA_CHOLDC</a>, <a href="LA_LUDC.htm#L_826528365_959749">LA_LUDC</a>, <a href="../S/SVDC.htm#S_820040301_52094">SVDC</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>