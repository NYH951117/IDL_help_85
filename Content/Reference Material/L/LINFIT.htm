<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: L">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>LINFIT </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="L_list.htm">Routines: L</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">LINFIT</span>
        </div>
        <h1 class="Routine"><a name="L_826528365_53763"></a><a name="kanchor1670"></a><a name="L_826528365_74603"></a>LINFIT </h1>
        <p><a name="kanchor1671"></a>The LINFIT function fits the paired data {<i>x</i><sub class="italic">i</sub>, <i>y</i><sub class="italic">i</sub>} to the linear model, y = A + Bx, by minimizing the chi-square error statistic. The chi-square error statistic is computed as</p>
        <p>
            <img src="../../images/18_28.jpg" />
        </p>
        <p>LINFIT is based upon the “fit” and “gammq” routines from <i>Numerical Recipes in C</i> (Second Edition). See section 15.2 of <i>Numerical Recipes in C</i> (Second Edition) for details.</p>
        <p>This routine is written in the IDL language. Its source code can be found in the file <code>linfit.pro</code> in the <code>lib</code> subdirectory of the IDL distribution.</p>
        <h2 class="API"><a name="L_826528365_53789"></a><a name="L_826528365_53789_PageTOC_LINFIT_"></a>Examples</h2>
        <p class="Code">; Define two n-element vectors of paired data:</p>
        <p class="Code">X = [-3.20, 4.49, -1.66, 0.64, -2.43, -0.89, -0.12, 1.41, $</p>
        <p class="Code">&#160;&#160;&#160;2.95, 2.18, 3.72, 5.26]</p>
        <p class="Code">Y = [-7.14, -1.30, -4.26, -1.90, -6.19, -3.98, -2.87, -1.66, $</p>
        <p class="Code">&#160;&#160;&#160;-0.78, -2.61, 0.31, 1.74]<br /><br />; Define an n-element vector of Poisson measurement errors:</p>
        <p class="Code">measure_errors = SQRT(ABS(Y))<br /><br />; Compute the model parameters, A and B, and print the result:</p>
        <p class="Code">result = LINFIT(X, Y, MEASURE_ERRORS=measure_errors)</p>
        <p class="Code">PRINT, result</p>
        <p>IDL prints:</p>
        <p class="Code">-3.16574&#160;&#160;&#160;&#160;0.829856</p>
        <h2 class="API"><a name="L_826528365_53769"></a><a name="L_826528365_53769_PageTOC_LINFIT_"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = LINFIT( <i>X</i>, <i>Y</i> [,&#160;<a href="#L_826528365_53778" class="selected">CHISQR</a>=<i>variable</i>] [,&#160;<a href="#L_826528365_940616" class="selected">COVAR</a>=<i>variable</i>] [,&#160;/<a href="#L_826528365_837073" class="selected">DOUBLE</a>] [,&#160;<a href="#L_826528365_53781" class="selected">MEASURE_ERRORS</a>=<i>vector</i>] [,&#160;<a href="#L_826528365_941301" class="selected">PROB</a>=<i>variable</i>] [,&#160;<a href="#L_826528365_941423" class="selected">SIGMA</a>=<i>variable</i>] [,&#160;<a href="#L_826528365_941298" class="selected">YFIT</a>=<i>variable</i>] )</p>
        <h2 class="API"><a name="L_826528365_962460"></a><a name="L_826528365_68611"></a>Return Value</h2>
        <p>The result is a two-element vector containing the linear model parameters [A, B].</p>
        <h2 class="API"><a name="L_826528365_53771"></a><a name="L_826528365_53771_PageTOC_LINFIT_"></a>Arguments</h2>
        <h3 class="Argument">X</h3>
        <p>An <i>n</i>-element vector containing the independent variable values. <i>X</i> may be of type integer, floating point, or double-precision floating-point. </p>
        <h3 class="Argument">Y</h3>
        <p>An <i>n</i>-element integer, single-, or double-precision floating-point vector.</p>
        <h2 class="API"><a name="L_826528365_53776"></a><a name="L_826528365_53776_PageTOC_LINFIT_"></a>Keywords</h2>
        <h3 class="Keyword"><a name="L_826528365_53778"></a><a name="L_826528365_53778_Keywords_LINFIT__"></a>CHISQR</h3>
        <p>Set this keyword to a named variable that will contain the value of the unreduced chi-square goodness-of-fit statistic.</p>
        <h3 class="Keyword"><a name="L_826528365_940616"></a><a name="L_826528365_940616_Keywords_LINFIT__"></a>COVAR</h3>
        <p>Set this keyword to a named variable that will contain the covariance matrix of the coefficients.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>The COVAR matrix depends only upon the independent variable X and (optionally) the MEASURE_ERRORS. The values do not depend upon Y. See section 15.4 of <i>Numerical Recipes in C</i> (Second Edition) for details.</p>
        <h3 class="Keyword"><a name="L_826528365_837073"></a><a name="L_826528365_837073_Keywords_LINFIT__"></a>DOUBLE </h3>
        <p>Set this keyword to force the computation to be done in double-precision arithmetic.</p>
        <h3 class="Keyword"><a name="L_826528365_53781"></a><a name="L_826528365_53781_Keywords_LINFIT__"></a><a name="L_826528365_33083"></a>MEASURE_ERRORS</h3>
        <p>Set this keyword to a vector containing standard measurement errors for each point <i>Y</i>[<i>i</i>]. This vector must be the same length as <i>X</i> and <i>Y</i>. When MEASURE_ERRORS is set, the chi-square error statistic is computed as</p>
        <p>
            <img src="../../images/18_30.jpg" />
        </p>
        <p>where σ represents the measurement error.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>For Gaussian errors (e.g., instrumental uncertainties), MEASURE_ERRORS should be set to the standard deviations of each point in <i>Y</i>. For Poisson or statistical weighting, MEASURE_ERRORS should be set to SQRT(ABS(<i>Y</i>)).</p>
        <h3 class="Keyword"><a name="L_826528365_941301"></a><a name="L_826528365_941301_Keywords_LINFIT__"></a>PROB</h3>
        <p>Set this keyword to a named variable that will contain the probability that the computed fit would have a value of CHISQ or greater. If PROB is greater than 0.1, the model parameters are “believable”. If PROB is less than 0.1, the accuracy of the model parameters is questionable.</p>
        <h3 class="Keyword"><a name="L_826528365_941423"></a><a name="L_826528365_941423_Keywords_LINFIT__"></a>SIGMA</h3>
        <p>Set this keyword to a named variable that will contain the 1-sigma uncertainty estimates for the returned parameters</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If MEASURE_ERRORS is omitted, then you are assuming that a straight line is the correct model for your data, and therefore, no independent goodness-of-fit test is possible. In this case, the values returned in SIGMA are multiplied by <br />SQRT(CHISQ/(<i>N</i>–<i>M</i>)), where <i>N</i> is the number of points in <i>X</i>, and <i>M</i> is the number of coefficients. See section 15.2 of <i>Numerical Recipes in C</i> (Second Edition) for details.</p>
        <h3 class="Keyword"><a name="L_826528365_941298"></a><a name="L_826528365_941298_Keywords_LINFIT__"></a>YFIT</h3>
        <p>Set this keyword equal to a named variable that will contain the vector of calculated <i>Y</i> values.</p>
        <h2 class="API"><a name="L_826528365_53801"></a><a name="L_826528365_53801_PageTOC_LINFIT_"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_ColSep">
                        <p>4.0</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>Pre 6.1</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Deprecated the SDEV keyword.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="L_826528365_952299"></a><a name="L_826528365_952299_PageTOC_LINFIT_"></a>See Also</h2>
        <p><a href="../C/COMFIT.htm#C_854643309_53189">COMFIT</a>, <a href="../C/CURVEFIT.htm#C_854643309_749660">CURVEFIT</a>, <a href="../G/GAUSSFIT.htm#G_845992557_749954">GAUSSFIT</a>, <a href="LADFIT.htm#L_826528365_825372">LADFIT</a>, <a href="LMFIT.htm#L_826528365_831031">LMFIT</a>, <a href="../P/POLY_FIT.htm#P_817877613_753815">POLY_FIT</a>, <a href="../R/REGRESS.htm#R_822202989_1102676">REGRESS</a>, <a href="../S/SFIT.htm#S_820040301_36073">SFIT</a>, <a href="../S/SVDFIT.htm#S_820040301_154010">SVDFIT</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>