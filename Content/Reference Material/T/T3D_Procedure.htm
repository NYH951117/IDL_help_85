<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: T">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>T3D Procedure</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="T_list.htm">Routines: T</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">T3D Procedure</span>
        </div>
        <h1 class="Routine"><a name="dg_routines_3604229493_887435"></a><a name="kanchor2515"></a><a name="dg_routines_3604229493_36880"></a>T3D Procedure</h1>
        <p><a name="kanchor2516"></a><a name="kanchor2517"></a><a name="kanchor2518"></a><a name="kanchor2519"></a><a name="kanchor2520"></a>The T3D procedure implements three-dimensional transforms.</p>
        <p>This routine accumulates one or more sequences of translation, scaling, rotation, perspective, and oblique transformations and stores the result in !P.T (the 3D transformation system variable) or in a variable specified by the MATRIX keyword. All the IDL Direct graphics routines use the value stored in !P.T when drawing output. Note that !P.T3D is <i>not</i> set, so for the transformations to have effect you must set !P.T3D = 1 (or set the T3D keyword in subsequent calls to graphics routines).</p>
        <p>Transformations are applied in the order of the following keywords: 1)<a href="#dg_routines_3604229493_887548" class="selected">RESET</a>, 2)&#160;<a href="#dg_routines_3604229493_887557" class="selected">TRANSLATE</a>, 3)&#160;<a href="#dg_routines_3604229493_887554" class="selected">SCALE</a>, 4)&#160;<a href="#dg_routines_3604229493_887551" class="selected">ROTATE</a>, 5)&#160;<a href="#dg_routines_3604229493_887545" class="selected">PERSPECTIVE</a>, 6)&#160;<a href="#dg_routines_3604229493_887539" class="selected">OBLIQUE</a>, 7)&#160;<a href="#dg_routines_3604229493_887560" class="selected">XYEXCH</a>, 8)&#160;<a href="#dg_routines_3604229493_887563" class="selected">XZEXCH</a>, 9)&#160;<a href="#dg_routines_3604229493_887566" class="selected">YZEXCH</a>. </p>
        <p>A right-handed system is used. Positive rotations are counterclockwise when looking from a positive axis position towards the origin.</p>
        <p>This routine is written in the IDL language. Its source code can be found in the file <code>t3d.pro</code> in the <code>lib</code> subdirectory of the IDL distribution.</p>
        <h2 class="API"><a name="dg_routines_3604229493_887496"></a><a name="dg_routines_3604229493_787447_PageTOC_T3D_"></a>Syntax</h2>
        <p class="Syntax">T3D [,&#160;<i>Array</i>][,&#160;/<a href="#dg_routines_3604229493_887548" class="selected">RESET</a>] [,&#160;<a href="#dg_routines_3604229493_887536" class="selected">MATRIX</a>=<i>variable</i>] [,&#160;<a href="#dg_routines_3604229493_887539" class="selected">OBLIQUE</a>=<i>vector</i>] [,&#160;<a href="#dg_routines_3604229493_887545" class="selected">PERSPECTIVE</a>=<i>p</i>{eye at 0,0,<i>p</i>}] [,&#160;<a href="#dg_routines_3604229493_887551" class="selected">ROTATE</a>=<i>[x</i>, <i>y</i>, <i>z]</i>] [,&#160;<a href="#dg_routines_3604229493_887554" class="selected">SCALE</a>=<i>[x</i>, <i>y</i>, <i>z]</i>] [,&#160;<a href="#dg_routines_3604229493_887557" class="selected">TRANSLATE</a>=<i>[x</i>, <i>y</i>, <i>z]</i>] [,&#160;/<a href="#dg_routines_3604229493_887560" class="selected">XYEXCH</a> | , /<a href="#dg_routines_3604229493_887563" class="selected">XZEXCH</a> | , /<a href="#dg_routines_3604229493_887566" class="selected">YZEXCH</a>]</p>
        <h2 class="API"><a name="dg_routines_3604229493_887529"></a><a name="dg_routines_3604229493_787449_PageTOC_T3D_"></a>Arguments</h2>
        <h3 class="Argument">Array</h3>
        <p>An optional 4 x 4 matrix used as the starting transformation. If <i>Array</i> is missing, the current !P.T transformation is used. <i>Array</i> is ignored if /RESET is set.</p>
        <h2 class="API"><a name="dg_routines_3604229493_887533"></a><a name="dg_routines_3604229493_1076334_PageTOC_T3D_"></a>Keywords</h2>
        <p>The transformation specified by each keyword is performed in the order of their descriptions below (e.g., if both TRANSLATE and SCALE are specified, the translation is done first).</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887536"></a><a name="dg_routines_3604229493_787453_Keywords_T3D__"></a>MATRIX</h3>
        <p>Set this keyword to a named variable that will contain the result. If this keyword is specified, !P.T is not modified.</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887539"></a><a name="dg_routines_3604229493_1076313_Keywords_T3D__"></a>OBLIQUE</h3>
        <p>A two-element vector of oblique projection parameters. Points are projected onto the XY plane at Z=0 as follows: </p>
        <p class="Code">x' = x + z(d * COS(a))</p>
        <p class="Code">y' = y + z(d * SIN(a))</p>
        <p>where OBLIQUE[0] = d and OBLIQUE[1] = a. An oblique projection is a parallel projection in which the normal to the projection plane is the <i>z</i>-axis, and the unit vector (0,&#160;0,&#160;1) is projected to (<i>d</i>&#160;cos&#160;α,&#160;<i>d</i>&#160;sin&#160;α) where  α is expressed in degrees.</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887545"></a><a name="dg_routines_3604229493_787459_Keywords_T3D__"></a>PERSPECTIVE</h3>
        <p>Perspective transformation. This parameter is a scalar (p) that indicates the Z distance of the center of the projection. Objects are projected into the XY plane at Z=0, and the “eye” is at point (0,0,p).</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887548"></a><a name="dg_routines_3604229493_787462_Keywords_T3D__"></a>RESET</h3>
        <p>Set this keyword to reset the transformation to the default identity matrix. Set this keyword to begin a new accumulation of transformations. If this keyword is not present, the current transformation matrix !P.T is post-multiplied by the new transformation. The final transformation matrix is always stored back in !P.T. If this keyword is set, the <i>Array</i> argument is ignored.</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887551"></a><a name="dg_routines_3604229493_787465_Keywords_T3D__"></a>ROTATE</h3>
        <p>A three-element vector of the rotations, in DEGREES, about the X, Y, and Z axes. The viewing area is rotated about each axis by the amount [θ<sub><i>x</i></sub>, θ<sub><i>y</i></sub>, θ<sub><i>z</i></sub>], in degrees. Rotations are performed in the order of X, Y, and then Z.</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887554"></a><a name="dg_routines_3604229493_787468_Keywords_T3D__"></a>SCALE</h3>
        <p>A three-element vector of scale factors for the X, Y, and Z axes. The viewing area is scaled by factor [<i>S</i><sub>x</sub>, <i>S</i><sub>y</sub>, <i>S</i><sub>z</sub>].</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887557"></a><a name="dg_routines_3604229493_787471_Keywords_T3D__"></a>TRANSLATE</h3>
        <p>A three-element vector of the translations in the X, Y, and Z directions. The viewpoint is translated by the three-element vector [<i>T</i><sub>x</sub>, <i>T</i><sub>y</sub>, <i>T</i><sub>z</sub>].</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887560"></a><a name="dg_routines_3604229493_787474_Keywords_T3D__"></a>XYEXCH</h3>
        <p>Set this keyword to exchange the X and Y axes.</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887563"></a><a name="dg_routines_3604229493_787477_Keywords_T3D__"></a>XZEXCH</h3>
        <p>Set this keyword to exchange the X and Z axes.</p>
        <h3 class="Keyword"><a name="dg_routines_3604229493_887566"></a><a name="dg_routines_3604229493_787480_Keywords_T3D__"></a>YZEXCH</h3>
        <p>Set this keyword to exchange the Y and Z axes.</p>
        <h2 class="API"><a name="dg_routines_3604229493_887569"></a><a name="dg_routines_3604229493_787482_PageTOC_T3D_"></a>Examples</h2>
        <p>To reset the transformation, rotate 30 degs about the X axis and do perspective transformation with the center of the projection at Z = -1, X=0, and Y=0, enter:</p>
        <p class="Code">T3D, /RESET, ROT = [ 30,0,0], PERS = 1.</p>
        <p>Transformations may be cascaded, for example:</p>
        <p class="Code">T3D, /RESET, TRANS = [-.5,-.5,0], ROT = [0,0,45] </p>
        <p class="Code">T3D, TRANS = [.5,.5,0]</p>
        <p>The first command resets, translates the point (.5,.5,0) to the center of the viewport, then rotates 45 degrees counterclockwise about the Z axis. The second call to T3D moves the origin back to the center of the viewport.</p>
        <h3><a name="dg_routines_3604229493_887580"></a>Establishing a Three-Dimensional Coordinate System</h3>
        <p>Usually, scaling parameters for coordinate conversion are set up by the higher-level procedures. To set up your own three-dimensional coordinate system with a given transformation matrix and <i>x</i>, <i>y</i>, <i>z</i> data range, follow these steps:</p>
        <ul>
            <li value="1">Establish the scaling from your data coordinates to normalized coordinates—the (0,&#160;1) cube. Assuming your data are contained in the range (<i>X</i><sub>min</sub>, <i>Y</i><sub>min</sub>, <i>Z</i><sub>min</sub>) to (<i>X</i><sub>max</sub>, <i>Y</i><sub>max</sub>, <i>Z</i><sub>max</sub>), set the data scaling system variables as follows:</li>
        </ul>
        <p class="Code_Indented">!X.S = [ -Xmin, 1 ] / (Xmax - Xmin)</p>
        <p class="Code_Indented">!Y.S = [ -Ymin, 1 ] / (Ymax - Ymin)</p>
        <p class="Code_Indented">!Z.S = [ -Zmin, 1 ] / (Zmax - Zmin)</p>
        <ul>
            <li value="1">Establish the transformation matrix that determines the view of the unit cube. This can be done by either calling T3D, as explained above or by directly manipulating !P.T yourself. If you wish to simply mimic the rotations provided by the SURFACE procedure, call the SCALE3 procedure (which can also be used to perform the previous step).</li>
        </ul>
        <h4><a name="dg_routines_3604229493_887588"></a><a name="dg_routines_3604229493_99057"></a>House Example</h4>
        <p>This example draws four views of a simple house. The procedure HOUSE defines the coordinates of the front and back faces of the house. The data-to-normal coordinate scaling is set, as shown above, to a volume about 25 percent larger than that enclosing the house. The PLOTS procedure is called to draw lines describing and connecting the front and back faces. XYOUTS is called to label the front and back faces.</p>
        <p>The commands shown after the definition of the HOUSE procedure contain four sequences of calls to T3D to establish the coordinate transformation, each followed by a call to HOUSE. </p>
        <p class="ExampleCode">If you prefer not to enter the IDL code by hand, run the batch file <code>showhaus<a name="kanchor2521"></a></code> with the following command at the IDL prompt:<br /><code>&#160;&#160;&#160;@showhaus</code></p>
        <p class="Code">PRO HOUSE</p>
        <p class="Code">&#160;&#160;&#160;; X coordinates of 10 vertices. First 5 are front face,</p>
        <p class="Code">&#160;&#160;&#160;; second 5 are back face. The range is 0 to 16.</p>
        <p class="Code">&#160;&#160;&#160;house_x = [0, 16, 16, 8, 0, 0, 16, 16, 8, 0]</p>
        <p class="Code">&#160;&#160;&#160;; The corresponding y values range from 0 to 16.</p>
        <p class="Code">&#160;&#160;&#160;house_y = [0, 0, 10, 16, 10, 0, 0, 10, 16, 10]</p>
        <p class="Code">&#160;&#160;&#160;; The z values range from 30 to 54.</p>
        <p class="Code">&#160;&#160;&#160;house_z = [54, 54, 54, 54, 54, 30, 30, 30, 30, 30]</p>
        <p class="Code">&#160;&#160;&#160;; Define max and min xy values to scale.</p>
        <p class="Code">&#160;&#160;&#160;; Slightly larger than data range.</p>
        <p class="Code">&#160;&#160;&#160;min_x = -4 &amp; max_x = 20.</p>
        <p class="Code">&#160;&#160;&#160;; Set x data scale to range from -4 to 20.</p>
        <p class="Code">&#160;&#160;&#160;!X.S = [-(-4), 1.]/(20 - (-4))</p>
        <p class="Code">&#160;&#160;&#160;; Same for y.</p>
        <p class="Code">&#160;&#160;&#160;!Y.S = !X.S</p>
        <p class="Code">&#160;&#160;&#160;; The z range is from 10 to 70.</p>
        <p class="Code">&#160;&#160;&#160;!Z.S = [-10, 1.]/(70 - 10)</p>
        <p class="Code">&#160;&#160;&#160;; Indices of front face.</p>
        <p class="Code">&#160;&#160;&#160;face = [INDGEN(5), 0]</p>
        <p class="Code">&#160;&#160;&#160;; Draw front face.</p>
        <p class="Code">&#160;&#160;&#160;PLOTS, house_x[face], house_y[face], $</p>
        <p class="Code">&#160;&#160;&#160;&#160;&#160;&#160;house_z[face], /T3D, /DATA</p>
        <p class="Code">&#160;&#160;&#160;; Draw back face.</p>
        <p class="Code">&#160;&#160;&#160;PLOTS, house_x[face + 5], house_y[face + 5], $</p>
        <p class="Code">&#160;&#160;&#160;&#160;&#160;&#160;house_z[face + 5], /T3D, /DATA</p>
        <p class="Code">&#160;&#160;&#160;; Connecting lines from front to back.</p>
        <p class="Code">&#160;&#160;&#160;FOR I = 0, 4 DO PLOTS, [house_x[i], house_x[i + 5]], $</p>
        <p class="Code">&#160;&#160;&#160;&#160;&#160;&#160;[house_y[i], house_y[i + 5]], $</p>
        <p class="Code">&#160;&#160;&#160;&#160;&#160;&#160;[house_z[i], house_z[i + 5]], /T3D, /DATA</p>
        <p class="Code">&#160;&#160;&#160;; Annotate front peak.</p>
        <p class="Code">&#160;&#160;&#160;XYOUTS, house_x[3], house_y[3], Z = house_z[3], 'Front', $</p>
        <p class="Code">&#160;&#160;&#160;&#160;&#160;&#160;/T3D, /DATA, SIZE = 2</p>
        <p class="Code">&#160;&#160;&#160;; Annotate back.</p>
        <p class="Code">&#160;&#160;&#160;XYOUTS, house_x[8], house_y[8], Z = house_z[8], 'Back', $</p>
        <p class="Code">&#160;&#160;&#160;&#160;&#160;&#160;/T3D, /DATA, SIZE = 2</p>
        <p class="Code">END</p>
        <p>The HOUSE procedure could be called from the IDL command line to produce a number of different plots. For example:</p>
        <p class="Code">; Set up no rotation, scale, and draw house.</p>
        <p class="Code">T3D, /RESET &amp; HOUSE</p>
        <p class="Code">; Create a handy constant.</p>
        <p class="Code">H = [0.5, 0.5, 0.5]</p>
        <p class="Code">; Straight projection after rotating 30 degrees about x and y axes.</p>
        <p class="Code">T3D, /RESET, TRANS = -H, ROT = [30, 30, 0] &amp; $</p>
        <p class="Code">&#160;&#160;&#160;T3D, TR = H &amp; HOUSE</p>
        <p class="Code">; No rotation, oblique projection, z factor = 0.5, angle = 45.</p>
        <p class="Code">T3D, /RESET, TRANS = -H, ROT=[0, 0, 0], OBLIQUE=[.5, -45] &amp; $</p>
        <p class="Code">&#160;&#160;&#160;T3D, TR = H &amp; HOUSE</p>
        <p class="Code">; Rotate 6 degrees about x and y, then apply perspective.</p>
        <p class="Code">T3D, /RESET, TR=-H, ROT=[-6, 6, 0], PERS=4 &amp; $</p>
        <p class="Code">&#160;&#160;&#160;T3D, TR=H &amp; HOUSE	</p>
        <p>
            <img src="../../Resources/Images/mult12.gif" style="margin-left: 5.99976px;margin-top: 5.99976px;margin-right: 6.000484px;margin-bottom: 6.000469px;" />
        </p>
        <p>The figure illustrates the different transformations. The four rotations are:</p>
        <ul>
            <li value="1">Upper left: no rotation, plain projection</li>
            <li value="2">Upper right: oblique projection, factor = 0.5, angle = –45</li>
            <li value="3">Bottom left: rotation of 30 degrees about both the <i>x</i>-and <i>y</i>-axes, plain projection</li>
            <li value="4">Bottom right: rotation of –6 degrees about the <i>x</i>-axis and +6 degrees about the <i>y</i>-axis, and perspective projection with the eye at 4.</li>
        </ul>
        <h3><a name="dg_routines_3604229493_887667"></a><a name="kanchor2522"></a>Rotating the House</h3>
        <p>A common procedure for visualizing three-dimensional data is to animate the data by rotating it about one or more axes. To make an animation of the house in the preceding example (<a href="#dg_routines_3604229493_887588" class="selected">House Example</a>), use the XINTERANIMATE procedure as follows:</p>
        <p class="Code">; Initialize animation: set frame size and number of frames.<br />sizx = 300<br />sizy = 300<br />nframes = 16<br />XINTERANIMATE, SET=[sizx, sizy, nframes]<br />; Rotate about the z axis. Draw the house.Save the window.<br />FOR i = 0, nframes - 1 DO BEGIN $<br />&#160;&#160;&#160;SCALE3, AX = 75, AZ = i * 360. / nframes &amp; $<br />&#160;&#160;&#160;ERASE &amp; $<br />&#160;&#160;&#160;HOUSE &amp; $<br />&#160;&#160;&#160;SCALE3, AX = 75, AZ = i * 360. / nframes &amp; $<br />&#160;&#160;&#160;XINTERANIMATE, FRAME=i, WINDOW=!D.WINDOW &amp; $<br />ENDFOR <br />; Show the animation.<br />XINTERANIMATE</p>
        <p>In the above example,  rather than SCALE3D is used to maintain the same scaling in all rotations. </p>
        <p class="ExampleCode">If you prefer not to enter the IDL code by hand, run the batch file <code>animhaus<a name="kanchor2523"></a></code> with the following command at the IDL prompt:<br /><code>&#160;&#160;&#160;@animhaus</code></p>
        <h3><a name="dg_routines_3604229493_887687"></a>Positioning Contours and Plots Three-Dimensions</h3>
        <p>The CONTOUR and PLOT procedures output their results using the three-dimensional coordinate transformation contained in !P.T when the keyword T3D is specified. Note that !P.T must contain a valid transformation matrix prior to using the T3D keyword.</p>
        <p>PLOT and its variants output graphs in the <i>xy</i>-plane at the normal coordinate <i>z</i> value given by the keyword ZVALUE. If this keyword is not specified, the plot is drawn at the bottom of the unit cube at <i>z</i> = 0.</p>
        <p><a name="dg_routines_3604229493_887690"></a>CONTOUR draws its axes at <i>z</i> = 0 and its contours at their <i>z</i> data value if ZVALUE is not specified. If ZVALUE is present, CONTOUR draws both the axes and contours in the <i>xy</i>-plane at the given <i>z</i><a name="dg_routines_3604229493_787489_PageTOC_T3D_"></a> value.</p>
        <h2 class="API"><a name="Version"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>Original</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API">Resources and References</h2>
        <p>This procedure is based on that of Foley &amp; Van Dam, Chapter 8, “Viewing in Three Dimensions” (Foley, J.D., and A. Van Dam (1982), <i>Fundamentals of Interactive Computer Graphics</i>, Addison-Wesley Publishing Co.).</p>
        <h2 class="API"><a name="dg_routines_3604229493_887712"></a><a name="dg_routines_3604229493_1086425_PageTOC_T3D_"></a>See Also</h2>
        <p><a href="../S/SCALE3_Procedure.htm#dg_routines_3604229493_884691">SCALE3 Procedure</a>, <a href="../S/SCALE3D_Procedure.htm#dg_routines_3604229493_884847">SCALE3D Procedure</a>, <a href="../S/SURFR_Procedure.htm#dg_routines_3604229493_887277">SURFR Procedure</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>