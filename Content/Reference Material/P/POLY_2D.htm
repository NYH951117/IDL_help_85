<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: P">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>POLY_2D </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="P_list.htm">Routines: P</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">POLY_2D</span>
        </div>
        <h1 class="Routine"><a name="P_817877613_678200"></a><a name="kanchor2058"></a><a name="P_817877613_17887"></a>POLY_2D </h1>
        <p><a name="kanchor2059"></a><a name="kanchor2060"></a><a name="kanchor2061"></a>The POLY_2D function performs polynomial warping of images. This function performs a geometrical transformation in which the resulting array is defined by:</p>
        <p class="indent"><i>g [x, y] = f [x', y'] = f [a [x, y], b [x, y]]</i>
        </p>
        <p>where <i>g</i>[<i>x</i>, <i>y</i>] represents the pixel in the output image at coordinate (<i>x</i>, <i>y</i>), and <i>f</i>&#160;[<i>x</i>',&#160;<i>y</i>'] is the pixel at (<i>x</i>',&#160;<i>y</i>') in the input image that is used to derive <i>g</i>[<i>x</i>, <i>y</i>]. The functions <i>a&#160;</i>(<i>x</i>, <i>y</i>) and <i>b</i>&#160;(<i>x</i>, <i>y</i>) are polynomials in <i>x</i> and <i>y</i> of degree <i>N</i>, whose coefficients are given by <i>P</i> and <i>Q</i>, and specify the spatial transformation:</p>
        <p>
            <img src="../../images/22_2.jpg" />
        </p>
        <p>Either the nearest neighbor or bilinear interpolation methods can be selected.</p>
        <h2 class="API">Examples</h2>
        <p>Some simple linear (degree one) transformations are:</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/Description.css');" cellspacing="0" class="TableStyle_Description">
            <col />
            <col />
            <col />
            <col />
            <col />
            <col />
            <col />
            <col />
            <col />
            <thead>
                <tr>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>P<i><sub>0,0</sub></i></p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>P<i><sub>1,0</sub></i></p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>P<i><sub>0,1</sub></i></p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>P<i><sub>1,1</sub></i></p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Q<i><sub>0,0</sub></i></p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Q<i><sub>1,0</sub></i></p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Q<i><sub>0,1</sub></i></p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
                        <p>Q<i><sub>1,1</sub></i></p>
                    </td>
                    <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
                        <p>Effect</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>Identity</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0.5</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>Stretch X by a factor of 2</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>2.0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
                        <p>Shrink Y by a factor of 2</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>z</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
                        <p>Shift left by z pixels</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>1</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
                        <p>0</p>
                    </td>
                    <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd">
                        <p>Transpose</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>POLY_2D is often used in conjunction with the POLYWARP procedure to warp images. </p>
        <p class="Code">; Create and display a simple image:<br />A = BYTSCL(SIN(DIST(250)), TOP=!D.TABLE_SIZE) &amp; TV, A<br /><br />; Set up the arrays of original points to be warped:<br />XO = [61, 62, 143, 133]<br />YO = [89, 34, 38, 105]<br /><br />; Set up the arrays of points to be fit:<br />XI = [24, 35, 102, 92]<br />YI = [81, 24, 25, 92]<br /><br />; Use POLYWARP to generate the P and Q inputs to POLY_2D:<br />POLYWARP, XI, YI, XO, YO, 1, P, Q<br /><br />; Perform an image warping based on P and Q:<br />B = POLY_2D(A, P, Q)<br /><br />; Display the new image:<br />TV, B, 250, 250</p>
        <p>Images can also be warped over irregularly gridded control points using the WARP_TRI procedure.</p>
        <h2 class="API">Syntax</h2>
        <p class="Syntax"><i>Result</i> = POLY_2D( <i>Array</i>, <i>P</i>, <i>Q</i> [,&#160;<i>Interp</i> [,&#160;<i>Dim</i><sub class="italic">x</sub>, <i>Dim</i><sub class="italic">y</sub>]] [,&#160;<a href="#P_817877613_678217" class="selected">CUBIC</a>={-1 to 0}] [,&#160;<a href="#P_817877613_680892" class="selected">MISSING</a>=<i>value</i>] [,&#160;<a href="#PIXELCENTER" class="selected">PIXEL_CENTER</a>=<i>value</i>])</p>
        <h2 class="API">Arguments</h2>
        <h3 class="Argument">Array</h3>
        <p>A two-dimensional array of any basic type except string. The result has the same type as <i>Array</i>.</p>
        <h3 class="Argument">P and Q</h3>
        <p><i>P</i> and <i>Q</i> are arrays containing the polynomial coefficients. Each array must contain (<i>N</i>+1)<sup>2</sup> elements (where <i>N</i> is the degree of the polynomial). For example, for a linear transformation, <i>P</i> and <i>Q</i> contain four elements and can be a 2 x 2 array or a 4-element vector. <i>P</i><sub class="italic">i,j</sub> contains the coefficient used to determine <i>x’</i>, and is the weight of the term <i>x</i><sup class="italic">j</sup><i>y</i><sup class="italic">i</sup>. The POLYWARP procedure can be used to fit <i>(x’, y’)</i> as a function of <i>(x, y)</i> and determines the coefficient arrays <i>P</i> and <i>Q</i>.</p>
        <h3 class="Argument">Interp</h3>
        <p>Set this argument to 1 to perform bilinear interpolation. Set this argument to 2 to perform cubic convolution interpolation (as described under the CUBIC keyword, below). Otherwise, the nearest neighbor method is used. For the linear case, (<i>N</i>=1), bilinear interpolation requires approximately twice as much time as does the nearest neighbor method. </p>
        <h3 class="Argument">Dim<sub class="italic">x</sub></h3>
        <p>If present, <i>Dim</i><sub class="italic">x</sub> specifies the number of columns in the output. If omitted, the output has the same number of columns as <i>Array</i>.</p>
        <h3 class="Argument">Dim<sub class="italic">y</sub></h3>
        <p>If present, <i>Dim</i><sub class="italic">y</sub> specifies the number of rows in the output. If omitted, the output has the same number of rows as <i>Array</i>.</p>
        <h2 class="API">Keywords</h2>
        <h3 class="Keyword"><a name="P_817877613_678217"></a><a name="P_817877613_678217_Keywords_POLY_2D__"></a><a name="kanchor2062"></a>CUBIC</h3>
        <p>Set this keyword to a value between -1 and 0 to use the cubic convolution interpolation method with the specified value as the interpolation parameter. Setting this keyword equal to a value greater than zero specifies a value of -1 for the interpolation parameter. Park and Schowengerdt (see reference below) suggest that a value of -0.5 significantly improves the reconstruction properties of this algorithm. Note that cubic convolution interpolation works only with one- and two-dimensional arrays.</p>
        <p>Cubic convolution is an interpolation method that closely approximates the theoretically optimum sinc interpolation function using cubic polynomials. According to sampling theory, details of which are beyond the scope of this document, if the original signal, <i>f</i>, is a band-limited signal, with no frequency component larger than ω<sub>0</sub>, and <i>f</i> is sampled with spacing less than or equal to 1/2ω<sub>0</sub>, then <i>f</i> can be reconstructed by convolving with a sinc function: sinc&#160;(<i>x</i>)&#160;=&#160;sin (π<i>x</i>) / (π<i>x</i>).</p>
        <p>In the one-dimensional case, four neighboring points are used, while in the two-dimensional case 16 points are used. Note that cubic convolution interpolation is significantly slower than bilinear interpolation.</p>
        <p>For further details see:</p>
        <p>Rifman, S.S. and McKinnon, D.M., “Evaluation of Digital Correction Techniques for ERTS Images; Final Report”, Report 20634-6003-TU-00, TRW Systems, Redondo Beach, CA, July 1974.</p>
        <p>S. Park and R. Schowengerdt, 1983 “Image Reconstruction by Parametric Cubic Convolution”, Computer Vision, Graphics &amp; Image Processing 23, 256.</p>
        <h3 class="Keyword"><a name="P_817877613_680892"></a><a name="P_817877613_680892_Keywords_POLY_2D__"></a>MISSING</h3>
        <p><a name="kanchor2063"></a>Specifies the output value for points whose <i>x’, y’</i> is outside the bounds of <i>Array</i>. If MISSING is not specified, the resulting output value is extrapolated from the nearest pixel of <i>Array</i>.</p>
        <h3 class="Keyword"><a name="PIXELCENTER"></a>PIXEL_CENTER</h3>
        <p>Set this keyword to a floating-point value giving the offset of the center of each input pixel. The default is 0.0 which indicates the lower-left corner of the pixel. A typical value would be 0.5, which would be the center of the pixel.</p>
        <h3>Thread Pool Keywords</h3>
        <p>This routine is written to make use of IDL’s <i>thread pool</i>, which can increase execution speed on systems with multiple CPUs. The values stored in the !CPU system variable control whether IDL uses the thread pool for a given computation. In addition, you can use the thread pool keywords TPOOL_MAX_ELTS, TPOOL_MIN_ELTS, and TPOOL_NOTHREAD to override the defaults established by !CPU for a single invocation of this routine. See <a href="../../Creating IDL Programs/Appendices/tpoolkeyw.htm#tpoolkeyw_2501860834_317209">Thread Pool Keywords</a> for details.</p>
        <h2 class="API">Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_ColSep">
                        <p>Original</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">8.3</td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">Added PIXEL_CENTER keyword</td>
                </tr>
            </tbody>
        </table>
        <h2 class="API">See Also</h2>
        <p><a href="POLYWARP.htm#P_817877613_758408">POLYWARP</a>
        </p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>