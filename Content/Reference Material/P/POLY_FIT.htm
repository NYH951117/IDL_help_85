<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: P">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>POLY_FIT </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="P_list.htm">Routines: P</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">POLY_FIT</span>
        </div>
        <h1 class="Routine"><a name="P_817877613_753815"></a><a name="kanchor2065"></a><a name="P_817877613_24656"></a>POLY_FIT </h1>
        <p><a name="kanchor2066"></a><a name="kanchor2067"></a>The POLY_FIT function performs a least-square polynomial fit with optional weighting and returns a vector of coefficients.</p>
        <p>The POLY_FIT routine uses matrix inversion to determine the coefficients. A different version of this routine, SVDFIT, uses singular value decomposition (SVD). The SVD technique is more flexible and robust, but may be slower.</p>
        <p>This routine is written in the IDL language. Its source code can be found in the file <code>poly_fit.pro</code> in the <code>lib</code> subdirectory of the IDL distribution.</p>
        <h2 class="API"><a name="P_817877613_753839"></a><a name="P_817877613_753839_PageTOC_POLY_FIT_"></a>Examples</h2>
        <p>In this example, we use X and Y data corresponding to the known polynomial <i>f</i>&#160;(x)&#160;=&#160;0.25 - x + x<sup>2</sup>. Using POLY_FIT to compute a second degree polynomial fit returns the exact coefficients (to within machine accuracy).</p>
        <p class="Code">; Define an 11-element vector of independent variable data:<br />X = [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]<br /><br />; Define an 11-element vector of dependent variable data:<br />Y = [0.25, 0.16, 0.09, 0.04, 0.01, 0.00, 0.01, 0.04, 0.09, $<br />&#160;&#160;&#160;0.16, 0.25]<br /><br />; Define a vector of measurement errors: <br />measure_errors = REPLICATE(0.01, 11)<br /><br />; Compute the second degree polynomial fit to the data:<br />result = POLY_FIT(X, Y, 2, MEASURE_ERRORS=measure_errors, $<br />&#160;&#160;&#160;SIGMA=sigma)<br /><br />; Print the coefficients:<br />PRINT, 'Coefficients: ', result<br />PRINT, 'Standard errors: ', sigma</p>
        <p>IDL prints:</p>
        <p class="Code">Coefficients:&#160;&#160;&#160;&#160;0.250000&#160;&#160;&#160;&#160;-1.00000&#160;&#160;&#160;&#160;1.00000</p>
        <p class="Code">Standard errors:&#160;&#160;&#160;&#160;0.00761853&#160;&#160;&#160;&#160;0.0354459&#160;&#160;&#160;&#160;0.0341395</p>
        <h2 class="API"><a name="P_817877613_753822"></a><a name="P_817877613_753822_PageTOC_POLY_FIT_"></a>Syntax</h2>
        <p class="Syntax"><i>Result</i> = POLY_FIT( <i>X</i>, <i>Y</i>, <i>Degree</i> [,&#160;<a href="#P_817877613_1073859" class="selected">CHISQ</a>=<i>variable</i>] [,&#160;<a href="#P_817877613_1073862" class="selected">COVAR</a>=<i>variable</i>] [,&#160;/<a href="#P_817877613_837040" class="selected">DOUBLE</a>] [,&#160;<a href="#P_817877613_1074498" class="selected">MEASURE_ERRORS</a>=<i>vector</i>] [,&#160;<a href="#P_817877613_1074050" class="selected">SIGMA</a>=<i>variable</i>] [,&#160;<a href="#P_817877613_1073417" class="selected">STATUS</a>=<i>variable</i>] [,&#160;<a href="#P_817877613_1074058" class="selected">YBAND</a>=<i>variable</i>] [,&#160;<a href="#P_817877613_1074060" class="selected">YERROR</a>=<i>variable</i>] [,&#160;<a href="#P_817877613_1074062" class="selected">YFIT</a>=<i>variable</i>] )</p>
        <h2 class="API"><a name="P_817877613_753824"></a><a name="P_817877613_753824_PageTOC_POLY_FIT_"></a>Return Value</h2>
        <p>POLY_FIT returns a vector of coefficients of length <i>Degree</i>+1. If the DOUBLE keyword is set, or if <i>X</i> or <i>Y</i> are double precision, then the result will be double precision, otherwise the result will be single precision.</p>
        <h2 class="API"><a name="P_817877613_1073810"></a><a name="P_817877613_1073810_PageTOC_POLY_FIT_"></a>Arguments</h2>
        <h3 class="Argument">X</h3>
        <p>An <i>n</i>-element vector containing the independent variable values. <i>X</i> may be of type integer, floating point, or double-precision floating-point. </p>
        <h3 class="Argument">Y</h3>
        <p>A vector of dependent variables, the same length as <i>X</i>.</p>
        <h3 class="Argument">Degree</h3>
        <p>The degree of the polynomial to fit.</p>
        <h2 class="API"><a name="P_817877613_837039"></a><a name="P_817877613_837039_PageTOC_POLY_FIT_"></a>Keywords</h2>
        <h3 class="Keyword"><a name="P_817877613_1073859"></a><a name="P_817877613_1073859_Keywords_POLY_FIT__"></a>CHISQ</h3>
        <p>Set this keyword to a named variable that will contain the value of the unreduced chi-square goodness-of-fit statistic.</p>
        <h3 class="Keyword"><a name="P_817877613_1073862"></a><a name="P_817877613_1073862_Keywords_POLY_FIT__"></a>COVAR</h3>
        <p>Set this keyword to a named variable that will contain the Covariance matrix of the coefficients.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>The COVAR matrix depends only upon the independent variable X and (optionally) the MEASURE_ERRORS. The values do not depend upon Y. See section 15.4 of <i>Numerical Recipes in C</i> (Second Edition) for details.</p>
        <h3 class="Keyword"><a name="P_817877613_837040"></a><a name="P_817877613_837040_Keywords_POLY_FIT__"></a>DOUBLE</h3>
        <p>Set this keyword to force computations to be done in double-precision arithmetic. All computations are performed using double-precision arithmetic.</p>
        <h3 class="Keyword"><a name="P_817877613_1074498"></a><a name="P_817877613_1074498_Keywords_POLY_FIT__"></a><a name="P_817877613_16106"></a>MEASURE_ERRORS</h3>
        <p>Set this keyword to a vector containing standard measurement errors for each point <i>Y</i>[<i>i</i>]. This vector must be the same length as <i>X</i> and <i>Y</i>.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>For Gaussian errors (e.g., instrumental uncertainties), MEASURE_ERRORS should be set to the standard deviations of each point in <i>Y</i>. For Poisson or statistical weighting, MEASURE_ERRORS should be set to SQRT(<i>Y</i>).</p>
        <h3 class="Keyword"><a name="P_817877613_1074050"></a><a name="P_817877613_1074050_Keywords_POLY_FIT__"></a>SIGMA</h3>
        <p>Set this keyword to a named variable that will contain the 1-sigma uncertainty estimates for the returned parameters.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If MEASURE_ERRORS is omitted, then you are assuming that a polynomial is the correct model for your data, and therefore, no independent goodness-of-fit test is possible. In this case, the values returned in SIGMA are multiplied by SQRT(CHISQ/(<i>N</i>–<i>M</i>)), where <i>N</i> is the number of points in <i>X</i>, and <i>M</i> is the number of coefficients. See section 15.2 of <i>Numerical Recipes in C</i> (Second Edition) for details.</p>
        <h3 class="Keyword"><a name="P_817877613_1073417"></a><a name="P_817877613_1073417_Keywords_POLY_FIT__"></a>STATUS</h3>
        <p>Set this keyword to a named variable to receive the status of the operation. Possible status values are:</p>
        <ul>
            <li value="1">0 = Successful completion.</li>
            <li value="2">1 = Singular array (which indicates that the inversion is invalid). <i>Result</i> is NaN.</li>
            <li value="3">2 = Warning that a small pivot element was used and that significant accuracy was probably lost.</li>
            <li value="4">3 = Undefined (NaN) error estimate was encountered.</li>
        </ul>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If STATUS is not specified, any error messages will be output to the screen.</p>
        <p class="Tip" data-mc-autonum="&lt;b&gt;Tip: &lt;/b&gt;"><span class="autonumber"><span><b>Tip: </b></span></span>Status values of 2 or 3 can often be resolved by setting the DOUBLE keyword.</p>
        <h3 class="Keyword"><a name="P_817877613_1074058"></a><a name="P_817877613_1074058_Keywords_POLY_FIT__"></a>YBAND</h3>
        <p>Set this keyword to a named variable that will contain the 1 standard deviation error estimate for each point.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If MEASURE_ERRORS is omitted, then you are assuming that a polynomial is the correct model for your data, and therefore, no independent goodness-of-fit test is possible. In this case, the values returned in YBAND are multiplied by YERROR (the standard error between YFIT and Y). See section 15.2 of <i>Numerical Recipes in C</i> (Second Edition) for details.</p>
        <h3 class="Keyword"><a name="P_817877613_1074060"></a><a name="P_817877613_1074060_Keywords_POLY_FIT__"></a>YERROR</h3>
        <p>Set this keyword to a named variable that will contain the standard error between YFIT and Y.</p>
        <h3 class="Keyword"><a name="P_817877613_1074062"></a><a name="P_817877613_1074062_Keywords_POLY_FIT__"></a>YFIT</h3>
        <p>Set this keyword to a named variable that will contain the vector of calculated <i>Y</i> values. These values have an error of + or – YBAND.</p>
        <h2 class="API"><a name="P_817877613_821472"></a><a name="P_817877613_821472_PageTOC_POLY_FIT_"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_ColSep">
                        <p>Original</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>5.4</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Deprecated the <i>Yfit</i>, <i>Yband</i>, <i>Sigma</i>, and <i>Corrm</i> arguments, added the MEASURE_ERRORS keyword.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="P_817877613_1079119"></a><a name="P_817877613_1079119_PageTOC_POLY_FIT_"></a>See Also</h2>
        <p><a href="../C/COMFIT.htm#C_854643309_53189">COMFIT</a>, <a href="../C/CURVEFIT.htm#C_854643309_749660">CURVEFIT</a>, <a href="../G/GAUSSFIT.htm#G_845992557_749954">GAUSSFIT</a>, <a href="../L/LINFIT.htm#L_826528365_53763">LINFIT</a>, <a href="../R/REGRESS.htm#R_822202989_1102676">REGRESS</a>, <a href="../S/SFIT.htm#S_820040301_36073">SFIT</a>, <a href="../S/SVDFIT.htm#S_820040301_154010">SVDFIT</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>