<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="idl.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Routines (alphabetical)|Routines: D">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>DFPMIN </title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Doc_Style.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><a class="MCBreadcrumbsLink" href="../../images/ref_part1.htm">Routines (alphabetical)</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="D_list.htm">Routines: D</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">DFPMIN</span>
        </div>
        <h1 class="Routine"><a name="D_843829869_861630"></a><a name="kanchor630"></a><a name="kanchor631"></a><a name="kanchor632"></a><a name="kanchor633"></a><a name="D_843829869_29412"></a>DFPMIN </h1>
        <p>The DFPMIN procedure minimizes a user-written function <i>Func</i> of two or more independent variables using the Broyden-Fletcher-Goldfarb-Shanno variant of the Davidon-Fletcher-Powell method, using its gradient as calculated by a user-written function <i>Dfunc</i>.</p>
        <p>DFPMIN is based on the routine <code>dfpmin</code> described in section 10.7 of <i>Numerical Recipes in C: The Art of Scientific Computing</i> (Second Edition), published by Cambridge University Press, and is used by permission.</p>
        <h2 class="API"><a name="D_843829869_50564"></a><a name="D_843829869_50564_PageTOC_DFPMIN_"></a>Examples</h2>
        <p>To minimize the function MINIMUM: </p>
        <p class="Code">PRO example_dfpmin</p>
        <p class="Code">&#160;</p>
        <p class="Code">&#160;&#160;&#160;; Make an initial guess (the algorithm’s starting point):</p>
        <p class="Code">&#160;&#160;&#160;X = [1.0, 1.0]</p>
        <p class="Code">&#160;</p>
        <p class="Code">&#160;&#160;&#160;; Set the convergence requirement on the gradient:</p>
        <p class="Code">&#160;&#160;&#160;Gtol = 1.0e-7</p>
        <p class="Code">&#160;</p>
        <p class="Code">&#160;&#160;&#160;; Find the minimizing value:</p>
        <p class="Code">&#160;&#160;&#160;DFPMIN, X, Gtol, Fmin, 'minimum', 'grad'</p>
        <p class="Code">&#160;</p>
        <p class="Code">&#160;&#160;&#160;; Print the minimizing value:</p>
        <p class="Code">&#160;&#160;&#160;PRINT, X</p>
        <p class="Code">&#160;</p>
        <p class="Code">END</p>
        <p class="Code">&#160;</p>
        <p class="Code">FUNCTION minimum, X </p>
        <p class="Code">&#160;&#160;&#160;RETURN, (X[0] - 3.0)^4 + (X[1] - 2.0)^2</p>
        <p class="Code">END</p>
        <p class="Code">&#160;</p>
        <p class="Code">FUNCTION grad, X</p>
        <p class="Code">&#160;&#160;&#160;RETURN, [4.0*(X[0] - 3.0)^3, 2.0*(X[1] - 2.0)]</p>
        <p class="Code">END</p>
        <p>IDL prints:</p>
        <p class="Code">&#160;&#160;3.00175&#160;&#160;2.00000</p>
        <h2 class="API"><a name="D_843829869_50516"></a><a name="D_843829869_50516_PageTOC_DFPMIN_"></a>Syntax</h2>
        <p class="Syntax">DFPMIN, <i>X</i>, <i>Gtol</i>, <i>Fmin</i>, <i>Func</i>, <i>Dfunc</i> [,&#160;/<a href="#D_843829869_50547" class="selected">DOUBLE</a>] [,&#160;<a href="#D_843829869_50550" class="selected">EPS</a>=<i>value</i>] [,&#160;<a href="#D_843829869_50553" class="selected">ITER</a>=<i>variable</i>] [,&#160;<a href="#D_843829869_50556" class="selected">ITMAX</a>=<i>value</i>] [,&#160;<a href="#D_843829869_50559" class="selected">STEPMAX</a>=<i>value</i>] [,&#160;<a href="#D_843829869_50562" class="selected">TOLX</a>=<i>value</i>]</p>
        <h2 class="API"><a name="D_843829869_50518"></a><a name="D_843829869_50518_PageTOC_DFPMIN_"></a>Arguments</h2>
        <h3 class="Argument">X</h3>
        <p>On input, <i>X</i> is an <i>n</i>-element vector specifying the starting point. On output, it is replaced with the location of the minimum.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note: &lt;/b&gt;"><span class="autonumber"><span><b>Note: </b></span></span>If  DFPMIN is complex then only the real part is used for the computation.</p>
        <h3 class="Argument">Gtol</h3>
        <p>An input value specifying the convergence requirement on zeroing the gradient.</p>
        <h3 class="Argument">Fmin</h3>
        <p>On output, <i>Fmin</i> contains the value at the minimum-point <i>X</i> of the user-supplied function specified by <i>Func</i>.</p>
        <h3 class="Argument">Func</h3>
        <p>A scalar string specifying the name of a user-supplied IDL function of two or more independent variables to be minimized. This function must accept a vector argument <i>X</i> and return a scalar result. </p>
        <p>For example, suppose we wish to find the minimum value of the function </p>
        <p class="indent"><i>y</i> = (<i>x</i><sub>0</sub> – 3)<sup>4 </sup>+ (<i>x</i><sub>1</sub> – 2)<sup>2</sup></p>
        <p>To evaluate this expression, we define an IDL function named MINIMUM:</p>
        <p class="Code">FUNCTION minimum, X </p>
        <p class="Code">&#160;&#160;&#160;RETURN, (X[0] - 3.0)^4 + (X[1] - 2.0)^2</p>
        <p class="Code">END</p>
        <h3 class="Argument">Dfunc</h3>
        <p>A scalar string specifying the name of a user-supplied IDL function that calculates the gradient of the function specified by <i>Func</i>. This function must accept a vector argument <i>X</i> and return a vector result. </p>
        <p>For example, the gradient of the above function is defined by the partial derivatives:</p>
        <p>
            <img src="../../images/10_3.jpg" />
        </p>
        <p>We can write a function GRAD to express these relationships in the IDL language:</p>
        <p class="Code">FUNCTION grad, X</p>
        <p class="Code">&#160;&#160;&#160;RETURN, [4.0*(X[0] - 3.0)^3, 2.0*(X[1] - 2.0)]</p>
        <p class="Code">END</p>
        <h2 class="API"><a name="D_843829869_50545"></a><a name="D_843829869_50545_PageTOC_DFPMIN_"></a>Keywords</h2>
        <h3 class="Keyword"><a name="D_843829869_50547"></a><a name="D_843829869_50547_Keywords_DFPMIN__"></a>DOUBLE</h3>
        <p>Set this keyword to force the computation to be done in double-precision arithmetic.</p>
        <h3 class="Keyword"><a name="D_843829869_50550"></a><a name="D_843829869_50550_Keywords_DFPMIN__"></a>EPS</h3>
        <p>Use this keyword to specify a number close to the machine precision. For single-precision calculations, the default value is 3.0&#160;x&#160;10<sup>-8</sup>. For double-precision calculations, the default value is 3.0&#160;x&#160;10<sup>-16</sup>.</p>
        <h3 class="Keyword"><a name="D_843829869_50553"></a><a name="D_843829869_50553_Keywords_DFPMIN__"></a>ITER</h3>
        <p>Use this keyword to specify a named variable which returns the number of iterations performed.</p>
        <h3 class="Keyword"><a name="D_843829869_50556"></a><a name="D_843829869_50556_Keywords_DFPMIN__"></a>ITMAX</h3>
        <p>Use this keyword to specify the maximum number of iterations allowed. The default value is 200.</p>
        <h3 class="Keyword"><a name="D_843829869_50559"></a><a name="D_843829869_50559_Keywords_DFPMIN__"></a>STEPMAX</h3>
        <p>Use this keyword to specify the scaled maximum step length allowed in line searches. The default value is 100.0</p>
        <h3 class="Keyword"><a name="D_843829869_50562"></a><a name="D_843829869_50562_Keywords_DFPMIN__"></a>TOLX</h3>
        <p>Use this keyword to specify the convergence criterion on <i>X</i> values. The default value is 4 x EPS.</p>
        <h2 class="API"><a name="D_843829869_50573"></a><a name="D_843829869_50573_PageTOC_DFPMIN_"></a>Version History</h2>
        <table style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
                        <p>4.0</p>
                    </td>
                    <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
                        <p>Introduced</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="API"><a name="D_843829869_997325"></a><a name="D_843829869_997325_PageTOC_DFPMIN_"></a>See Also</h2>
        <p><a href="../A/AMOEBA.htm#A_850317933_992475">AMOEBA</a>, &#160;<a href="../P/POWELL.htm#P_817877613_51436">POWELL</a>, <a href="../S/SIMPLEX.htm#S_820040301_1103717">SIMPLEX</a></p>
        <div class="mp_footer">© <span class="DocumentTitleCopyrightYear">2015</span>&#160;<span class="DocumentTitleCopyrightCompanyName">Exelis Visual Information Solutions, Inc., a subsidiary of Harris Corporation</span>. All Rights Reserved. This information is not subject to the controls of the International Traffic in Arms Regulations (ITAR) or the Export Administration Regulations (EAR). However, this information may be restricted from transfer to various embargoed countries under U.S. laws and regulations.</div>
    </body>
</html>